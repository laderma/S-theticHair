function stripBOM(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}function intercept(e,n){var t=stripBOM(fs.readFileSync(n,"utf8"));amdefineRegExp.test(e.id)||(t=inserted+t),e._compile(t,n)}var inserted,Module=require("module"),fs=require("fs"),existingExtFn=Module._extensions[".js"],amdefineRegExp=/amdefine\.js/;inserted="if (typeof define !== 'function') {var define = require('amdefine')(module)}",intercept._id="amdefine/intercept",existingExtFn._id&&existingExtFn._id===intercept._id||(Module._extensions[".js"]=intercept);