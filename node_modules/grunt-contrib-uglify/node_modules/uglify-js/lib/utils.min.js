"use strict";function array_to_hash(e){for(var n=Object.create(null),t=0;t<e.length;++t)n[e[t]]=!0;return n}function slice(e,n){return Array.prototype.slice.call(e,n||0)}function characters(e){return e.split("")}function member(e,n){for(var t=n.length;--t>=0;)if(n[t]==e)return!0;return!1}function find_if(e,n){for(var t=0,r=n.length;r>t;++t)if(e(n[t]))return n[t]}function repeat_string(e,n){if(0>=n)return"";if(1==n)return e;var t=repeat_string(e,n>>1);return t+=t,1&n&&(t+=e),t}function DefaultsError(e,n){Error.call(this,e),this.msg=e,this.defs=n}function defaults(e,n,t){e===!0&&(e={});var r=e||{};if(t)for(var a in r)r.hasOwnProperty(a)&&!n.hasOwnProperty(a)&&DefaultsError.croak("`"+a+"` is not a supported option",n);for(var a in n)n.hasOwnProperty(a)&&(r[a]=e&&e.hasOwnProperty(a)?e[a]:n[a]);return r}function merge(e,n){var t=0;for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r],t++);return t}function noop(){}function push_uniq(e,n){e.indexOf(n)<0&&e.push(n)}function string_template(e,n){return e.replace(/\{(.+?)\}/g,function(e,t){return n[t]})}function remove(e,n){for(var t=e.length;--t>=0;)e[t]===n&&e.splice(t,1)}function mergeSort(e,n){function t(e,t){for(var r=[],a=0,i=0,s=0;a<e.length&&i<t.length;)n(e[a],t[i])<=0?r[s++]=e[a++]:r[s++]=t[i++];return a<e.length&&r.push.apply(r,e.slice(a)),i<t.length&&r.push.apply(r,t.slice(i)),r}function r(e){if(e.length<=1)return e;var n=Math.floor(e.length/2),a=e.slice(0,n),i=e.slice(n);return a=r(a),i=r(i),t(a,i)}return e.length<2?e.slice():r(e)}function set_difference(e,n){return e.filter(function(e){return n.indexOf(e)<0})}function set_intersection(e,n){return e.filter(function(e){return n.indexOf(e)>=0})}function makePredicate(e){function i(e){if(1==e.length)return n+="return str === "+JSON.stringify(e[0])+";";n+="switch(str){";for(var t=0;t<e.length;++t)n+="case "+JSON.stringify(e[t])+":";n+="return true}return false;"}e instanceof Array||(e=e.split(" "));var n="",t=[];e:for(var r=0;r<e.length;++r){for(var a=0;a<t.length;++a)if(t[a][0].length==e[r].length){t[a].push(e[r]);continue e}t.push([e[r]])}if(t.length>3){t.sort(function(e,n){return n.length-e.length}),n+="switch(str.length){";for(var r=0;r<t.length;++r){var s=t[r];n+="case "+s[0].length+":",i(s)}n+="}"}else i(e);return new Function("str",n)}function all(e,n){for(var t=e.length;--t>=0;)if(!n(e[t]))return!1;return!0}function Dictionary(){this._values=Object.create(null),this._size=0}DefaultsError.prototype=Object.create(Error.prototype),DefaultsError.prototype.constructor=DefaultsError,DefaultsError.croak=function(e,n){throw new DefaultsError(e,n)};var MAP=function(){function e(e,i,s){function c(){var c=i(e[u],u),f=c instanceof a;return f&&(c=c.v),c instanceof t?(c=c.v,c instanceof r?l.push.apply(l,s?c.v.slice().reverse():c.v):l.push(c)):c!==n&&(c instanceof r?o.push.apply(o,s?c.v.slice().reverse():c.v):o.push(c)),f}var u,o=[],l=[];if(e instanceof Array)if(s){for(u=e.length;--u>=0&&!c(););o.reverse(),l.reverse()}else for(u=0;u<e.length&&!c();++u);else for(u in e)if(e.hasOwnProperty(u)&&c())break;return l.concat(o)}function t(e){this.v=e}function r(e){this.v=e}function a(e){this.v=e}e.at_top=function(e){return new t(e)},e.splice=function(e){return new r(e)},e.last=function(e){return new a(e)};var n=e.skip={};return e}();Dictionary.prototype={set:function(e,n){return this.has(e)||++this._size,this._values["$"+e]=n,this},add:function(e,n){return this.has(e)?this.get(e).push(n):this.set(e,[n]),this},get:function(e){return this._values["$"+e]},del:function(e){return this.has(e)&&(--this._size,delete this._values["$"+e]),this},has:function(e){return"$"+e in this._values},each:function(e){for(var n in this._values)e(this._values[n],n.substr(1))},size:function(){return this._size},map:function(e){var n=[];for(var t in this._values)n.push(e(this._values[t],t.substr(1)));return n},toObject:function(){return this._values}},Dictionary.fromObject=function(e){var n=new Dictionary;return n._size=merge(n._values,e),n};