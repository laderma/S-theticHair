"use strict";var NodeHTTPParser=process.binding("http_parser").HTTPParser,version=NodeHTTPParser.RESPONSE?6:4,HttpParser=function(e){"request"===e?this._parser=new NodeHTTPParser(NodeHTTPParser.REQUEST||"request"):this._parser=new NodeHTTPParser(NodeHTTPParser.RESPONSE||"response"),this._type=e,this._complete=!1,this.headers={};var n=null,t=this;this._parser.onHeaderField=function(e,t,r){n=e.toString("utf8",t,t+r).toLowerCase()},this._parser.onHeaderValue=function(e,r,i){var a=e.toString("utf8",r,r+i);t.headers.hasOwnProperty(n)?t.headers[n]+=", "+a:t.headers[n]=a},this._parser.onHeadersComplete=this._parser[NodeHTTPParser.kOnHeadersComplete]=function(e,n,r,i,a,o){var s=arguments[0];if("object"==typeof s&&(i=s.method,a=s.url,o=s.statusCode,r=s.headers),t.method="number"==typeof i?HttpParser.METHODS[i]:i,t.statusCode=o,t.url=a,r){for(var c,f,u=0,l=r.length;l>u;u+=2)c=r[u].toLowerCase(),f=r[u+1],t.headers.hasOwnProperty(c)?t.headers[c]+=", "+f:t.headers[c]=f;t._complete=!0}}};HttpParser.METHODS={0:"DELETE",1:"GET",2:"HEAD",3:"POST",4:"PUT",5:"CONNECT",6:"OPTIONS",7:"TRACE",8:"COPY",9:"LOCK",10:"MKCOL",11:"MOVE",12:"PROPFIND",13:"PROPPATCH",14:"SEARCH",15:"UNLOCK",16:"REPORT",17:"MKACTIVITY",18:"CHECKOUT",19:"MERGE",24:"PATCH"},HttpParser.prototype.isComplete=function(){return this._complete},HttpParser.prototype.parse=function(e){var n=6>version?1:0,t=this._parser.execute(e,0,e.length)+n;this._complete&&(this.body=t<e.length?e.slice(t):new Buffer(0))},module.exports=HttpParser;