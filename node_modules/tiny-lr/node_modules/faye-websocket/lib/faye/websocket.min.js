var util=require("util"),driver=require("websocket-driver"),API=require("./websocket/api"),WebSocket=function(e,n,t,r,i){i=i||{},this._stream=n,this._driver=driver.http(e,{maxLength:i.maxLength,protocols:r});var a=this;if(this._stream&&this._stream.writable){var o=function(){a._stream.removeListener("data",o)};this._stream.on("data",o),this._driver.io.write(t),API.call(this,i),process.nextTick(function(){a._driver.start()})}};util.inherits(WebSocket,API),WebSocket.isWebSocket=function(e){return driver.isWebSocket(e)},WebSocket.WebSocket=WebSocket,WebSocket.Client=require("./websocket/client"),WebSocket.EventSource=require("./eventsource"),module.exports=WebSocket;