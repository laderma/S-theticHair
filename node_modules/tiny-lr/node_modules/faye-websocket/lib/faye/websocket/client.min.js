var util=require("util"),net=require("net"),tls=require("tls"),driver=require("websocket-driver"),API=require("./api"),Event=require("./api/event"),Client=function(e,n,t){t=t||{},this.url=e,this._uri=require("url").parse(e),this._driver=driver.client(e,{maxLength:t.maxLength,protocols:n}),["open","error"].forEach(function(e){this._driver.on(e,function(){o.headers=o._driver.headers,o.statusCode=o._driver.statusCode})},this);var r="wss:"===this._uri.protocol,i=function(){o._driver.start()},a={},o=this;t.ca&&(a.ca=t.ca);var s=r?tls.connect(this._uri.port||443,this._uri.hostname,a,i):net.createConnection(this._uri.port||80,this._uri.hostname);this._stream=s,r||this._stream.on("connect",i),API.call(this,t)};util.inherits(Client,API),module.exports=Client;