function urlencoded(e){function s(e){return e.length?o(e):{}}e=e||{},void 0===e.extended&&deprecate("undefined extended: provide extended option");var n=e.extended!==!1,t=e.inflate!==!1,r="number"!=typeof e.limit?bytes(e.limit||"100kb"):e.limit,i=e.type||"urlencoded",a=e.verify||!1;if(a!==!1&&"function"!=typeof a)throw new TypeError("option verify must be function");var o=n?extendedparser(e):simpleparser(e);return function(e,n,o){if(e._body)return o();if(e.body=e.body||{},!typeis(e,i))return o();var u=typer.parse(e).parameters.charset||"utf-8";if("utf-8"!==u.toLowerCase()){var l=new Error("unsupported charset");return l.status=415,void o(l)}read(e,n,o,s,{encoding:u,inflate:t,limit:r,verify:a})}}function extendedparser(e){var n=void 0!==e.parameterLimit?e.parameterLimit:1e3,t=parser("qs");if(isNaN(n)||1>n)throw new TypeError("option parameterLimit must be a positive number");isFinite(n)&&(n=0|n);var r={arrayLimit:100,parameterLimit:n};return function(e){if(overlimit(e,n)){var i=new Error("too many parameters");throw i.status=413,i}return t(e,r)}}function overlimit(e,n){if(n===1/0)return!1;for(var t=0,r=0;-1!==(r=e.indexOf("&",r));)if(t++,r++,t===n)return!0;return!1}function parser(e){var n=parsers[e];return n?n.parse:(n=parsers[e]=require(e),n.parse)}function simpleparser(e){var n=void 0!==e.parameterLimit?e.parameterLimit:1e3,t=parser("querystring");if(isNaN(n)||1>n)throw new TypeError("option parameterLimit must be a positive number");return isFinite(n)&&(n=0|n),function(e){if(overlimit(e,n)){var r=new Error("too many parameters");throw r.status=413,r}return t(e,void 0,void 0,{maxKeys:n})}}var bytes=require("bytes"),deprecate=require("depd")("body-parser"),read=require("../read"),typer=require("media-typer"),typeis=require("type-is");module.exports=urlencoded;var parsers=Object.create(null);