function checkResultHidden(e,n){var t=[".hidden",".hidden.txt","bar.txt","foo",path.join(".hidden","dolor.md"),path.join("foo","bar"),path.join("foo","dolor.md"),path.join("foo","lorem.txt"),path.join("foo","bar","ipsum.js")];e.deepEqual(n,t)}function checkResultShown(e,n){var t=["bar.txt","foo",path.join("foo","bar"),path.join("foo","dolor.md"),path.join("foo","lorem.txt"),path.join("foo","bar","ipsum.js")];e.deepEqual(n,t)}function checkResultInflate(e,n){var t=[".hidden","bar.txt","test",path.join(".hidden","dolor.md")];e.deepEqual(n,t),e.deepEqual(fs.lstatSync(path.join(__dirname,"testdir/.hidden")).isSymbolicLink(),!1),e.deepEqual(fs.lstatSync(path.join(__dirname,"testdir/bar.txt")).isSymbolicLink(),!1)}function checkResultInflateAbsolute(e,n){var t=[".hidden","absolute-bar.txt","bar.txt","test",path.join(".hidden","dolor.md")];e.deepEqual(n,t),e.deepEqual(fs.lstatSync(path.join(__dirname,"testdir/.hidden")).isSymbolicLink(),!1),e.deepEqual(fs.lstatSync(path.join(__dirname,"testdir/bar.txt")).isSymbolicLink(),!1)}function checkResultDontInflate(e,n){var t=[".hidden","bar.txt","test",path.join(".hidden","dolor.md")];e.deepEqual(n,t),e.deepEqual(fs.lstatSync(path.join(__dirname,"testdir/.hidden")).isSymbolicLink(),!0),e.deepEqual(fs.lstatSync(path.join(__dirname,"testdir/bar.txt")).isSymbolicLink(),!0)}function checkResultPreserveFiles(e,n){checkResultHidden(e,n);var t=fs.readFileSync(path.join(__dirname,path.join("testdir2",".hidden.txt")),"utf8");e.deepEqual(t,"hidden file"),t=fs.readFileSync(path.join(__dirname,path.join("testdir2","bar.txt")),"utf8"),e.deepEqual(t,"shown file")}function checkResultOverwriteFiles(e,n){checkResultHidden(e,n);var t=fs.readFileSync(path.join(__dirname,path.join("testdir2",".hidden.txt")),"utf8");e.deepEqual(t,"just some text for .hidden.txt"),t=fs.readFileSync(path.join(__dirname,path.join("testdir2","bar.txt")),"utf8"),e.deepEqual(t,"just some text for bar.txt")}var testCase=require("nodeunit").testCase,fs=require("fs"),wrench=require("../lib/wrench"),path=require("path");module.exports=testCase({test_copyDirSyncRecursiveWithoutOptions:function(e){var n=path.join(__dirname,"shown"),t=path.join(__dirname,"testdir");wrench.copyDirSyncRecursive(n,t),wrench.rmdirSyncRecursive(t),e.done()},test_copyDirSyncRecursiveHidden:function(e){var n=path.join(__dirname,"shown"),t=path.join(__dirname,"testdir");e.ok(fs.existsSync(n),"Folders should exist"),wrench.copyDirSyncRecursive(n,t,{excludeHiddenUnix:!1});var r=wrench.readdirSyncRecursive(t);checkResultHidden(e,r),wrench.rmdirSyncRecursive(t),e.done()},test_copyDirSyncRecursiveShown:function(e){var n=path.join(__dirname,"shown"),t=path.join(__dirname,"testdir");e.ok(fs.existsSync(n),"Folders should exist"),wrench.copyDirSyncRecursive(n,t,{excludeHiddenUnix:!0});var r=wrench.readdirSyncRecursive(t);checkResultShown(e,r),wrench.rmdirSyncRecursive(t),e.done()},test_copyDirSyncRecursiveInflate:function(e){var n=path.join(__dirname,"withsymlinks"),t=path.join(__dirname,"testdir");e.ok(fs.existsSync(n),"Folders should exist"),wrench.copyDirSyncRecursive(n,t,{excludeHiddenUnix:!1,inflateSymlinks:!0});var r=wrench.readdirSyncRecursive(t);checkResultInflate(e,r),wrench.rmdirSyncRecursive(t),e.done()},test_copyDirSyncRecursiveInflateAbsoluteSymlinks:function(e){var n=path.join(__dirname,"withsymlinks"),t=path.join(__dirname,"testdir");fs.symlinkSync(path.resolve(__dirname,"shown/bar.txt"),path.join(n,"absolute-bar.txt")),wrench.mkdirSyncRecursive(t,511),wrench.copyDirSyncRecursive(n,t,{forceDelete:!0,excludeHiddenUnix:!1,inflateSymlinks:!0});var r=wrench.readdirSyncRecursive(t);checkResultInflateAbsolute(e,r),wrench.rmdirSyncRecursive(t),fs.unlinkSync(path.join(n,"absolute-bar.txt")),e.done()},test_copyDirSyncRecursiveDontInflate:function(e){var n=path.join(__dirname,"withsymlinks"),t=path.join(__dirname,"testdir");e.ok(fs.existsSync(n),"Folders should exist"),wrench.copyDirSyncRecursive(n,t,{excludeHiddenUnix:!1,inflateSymlinks:!1});var r=wrench.readdirSyncRecursive(t);checkResultDontInflate(e,r),wrench.rmdirSyncRecursive(t),e.done()},test_copyDirSyncRecursivePreserveFiles:function(e){var n=path.join(__dirname,"shown"),t=path.join(__dirname,"testdir1"),r=path.join(__dirname,"testdir2");e.ok(fs.existsSync(n),"Folders should exist"),wrench.copyDirSyncRecursive(n,t,{excludeHiddenUnix:!1}),wrench.copyDirSyncRecursive(n,r,{excludeHiddenUnix:!1}),fs.writeFileSync(path.join(t,".hidden.txt"),"just some text for .hidden.txt"),fs.writeFileSync(path.join(t,"bar.txt"),"just some text for bar.txt"),wrench.copyDirSyncRecursive(t,r,{excludeHiddenUnix:!1,preserveFiles:!0});var a=wrench.readdirSyncRecursive(r);checkResultPreserveFiles(e,a),wrench.rmdirSyncRecursive(t),wrench.rmdirSyncRecursive(r),e.done()},test_copyDirSyncRecursiveOverwriteFiles:function(e){var n=path.join(__dirname,"shown"),t=path.join(__dirname,"testdir1"),r=path.join(__dirname,"testdir2");e.ok(fs.existsSync(n),"Folders should exist"),wrench.copyDirSyncRecursive(n,t,{excludeHiddenUnix:!1}),wrench.copyDirSyncRecursive(n,r,{excludeHiddenUnix:!1}),fs.writeFileSync(path.join(t,".hidden.txt"),"just some text for .hidden.txt"),fs.writeFileSync(path.join(t,"bar.txt"),"just some text for bar.txt"),wrench.copyDirSyncRecursive(t,r,{forceDelete:!0,excludeHiddenUnix:!1,preserveFiles:!1});var a=wrench.readdirSyncRecursive(r);checkResultOverwriteFiles(e,a),wrench.rmdirSyncRecursive(t),wrench.rmdirSyncRecursive(r),e.done()}});