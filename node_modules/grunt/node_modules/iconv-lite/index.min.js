function toInternalEncoding(e){return new Buffer(ensureString(e),this.options.originalEncoding)}function fromInternalEncoding(e){return ensureBuffer(e).toString(this.options.originalEncoding)}function toTableEncoding(e){e=ensureString(e);for(var a,i,n=e.length,t=this.options.revCharsTable,r=new Buffer(2*n),s=t[iconv.defaultCharUnicode.charCodeAt(0)],o=0,l=0;n>o;o++)i=e.charCodeAt(o),i>>7?(a=t[i]||s,r[l++]=a>>8,r[l++]=255&a):r[l++]=i;return r.slice(0,l)}function fromTableEncoding(e){e=ensureBuffer(e);for(var a,i,n=e.length,t=this.options.table,r=new Buffer(2*n),s=iconv.defaultCharUnicode.charCodeAt(0),o=0,l=0;n>o;o++,l+=2)i=e[o],128&i?(i=(i<<8)+e[++o],a=t[i]||s):a=i,r[l]=255&a,r[l+1]=a>>8;return r.slice(0,l).toString("ucs2")}function toSingleByteEncoding(e){e=ensureString(e);for(var n=new Buffer(e.length),t=this.options.revCharsBuf,r=0;r<e.length;r++)n[r]=t[e.charCodeAt(r)];return n}function fromSingleByteEncoding(e){e=ensureBuffer(e);for(var n=this.options.charsBuf,t=new Buffer(2*e.length),r=0,a=0,i=0,s=e.length;s>i;i++)r=2*e[i],a=2*i,t[a]=n[r],t[a+1]=n[r+1];return t.toString("ucs2")}function loadEncodings(){iconv.encodingsLoaded||([require("./encodings/singlebyte"),require("./encodings/gbk"),require("./encodings/big5")].forEach(function(e){for(var n in e)iconv.encodings[n]=e[n]}),iconv.encodingsLoaded=!0)}var RE_SPACEDASH=/[- ]/g,iconv=module.exports={toEncoding:function(e,n){return iconv.getCodec(n).toEncoding(e)},fromEncoding:function(e,n){return iconv.getCodec(n).fromEncoding(e)},encodingExists:function(e){return loadEncodings(),e=e.replace(RE_SPACEDASH,"").toLowerCase(),void 0!==iconv.encodings[e]},defaultCharUnicode:"ï¿½",defaultCharSingleByte:"?",encodingsLoaded:!1,getCodec:function(e){loadEncodings();for(var n=e||"utf8",t=void 0;;){"String"===getType(n)&&(n=n.replace(RE_SPACEDASH,"").toLowerCase());var r=iconv.encodings[n],a=getType(r);if("String"===a)t={originalEncoding:n},n=r;else{if("Object"!==a||void 0==r.type){if("Function"===a)return r(t);throw new Error("Encoding not recognized: '"+e+"' (searched as: '"+n+"')")}t=r,n=r.type}}},encodings:{internal:function(e){return{toEncoding:toInternalEncoding,fromEncoding:fromInternalEncoding,options:e}},utf8:"internal",ucs2:"internal",binary:"internal",ascii:"internal",base64:"internal",singlebyte:function(e){if(!e.charsBuf){if(!e.chars||128!==e.chars.length&&256!==e.chars.length)throw new Error("Encoding '"+e.type+"' has incorrect 'chars' (must be of len 128 or 256)");128===e.chars.length&&(e.chars=asciiString+e.chars),e.charsBuf=new Buffer(e.chars,"ucs2")}if(!e.revCharsBuf){e.revCharsBuf=new Buffer(65536);for(var n=iconv.defaultCharSingleByte.charCodeAt(0),t=0;t<e.revCharsBuf.length;t++)e.revCharsBuf[t]=n;for(var t=0;t<e.chars.length;t++)e.revCharsBuf[e.chars.charCodeAt(t)]=t}return{toEncoding:toSingleByteEncoding,fromEncoding:fromSingleByteEncoding,options:e}},table:function(e){if(!e.table)throw new Error("Encoding '"+e.type+"' has incorect 'table' option");if(!e.revCharsTable){for(var n=e.revCharsTable={},t=0;65535>=t;t++)n[t]=0;var r=e.table;for(var a in r)n[r[a]]=+a}return{toEncoding:toTableEncoding,fromEncoding:fromTableEncoding,options:e}}}};iconv.encode=iconv.toEncoding,iconv.decode=iconv.fromEncoding;var asciiString="\x00\b	\n\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",ensureBuffer=function(e){return e=e||new Buffer(0),e instanceof Buffer?e:new Buffer(""+e,"binary")},ensureString=function(e){return e=e||"",e instanceof Buffer?e.toString("utf8"):""+e},getType=function(e){return Object.prototype.toString.call(e).slice(8,-1)};