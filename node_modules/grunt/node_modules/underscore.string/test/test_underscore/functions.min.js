$(document).ready(function(){module("Functions"),test("functions: bind",function(){var e={name:"moe"},n=function(e){return"name: "+(this.name||e)},t=_.bind(n,e);equals(t(),"name: moe","can bind a function to a context"),t=_(n).bind(e),equals(t(),"name: moe","can do OO-style binding"),t=_.bind(n,null,"curly"),equals(t(),"name: curly","can bind without specifying a context"),n=function(e,n){return e+": "+n},n=_.bind(n,this,"hello"),equals(n("moe"),"hello: moe","the function was partially applied in advance");var n=_.bind(n,this,"curly");equals(n(),"hello: curly","the function was completely applied in advance");var n=function(e,n,t){return e+": "+n+" "+t};n=_.bind(n,this,"hello","moe","curly"),equals(n(),"hello: moe curly","the function was partially applied in advance and can accept multiple arguments"),n=function(e,n){equals(this,e,n)},_.bind(n,0,0,"can bind a function to `0`")(),_.bind(n,"","","can bind a function to an empty string")(),_.bind(n,!1,!1,"can bind a function to `false`")();var r=function(){return this},a=_.bind(r,{hello:"moe curly"});equal((new a).hello,void 0,"function should not be bound to the context, to comply with ECMAScript 5"),equal(a().hello,"moe curly","When called without the new operator, it's OK to be bound to the context")}),test("functions: bindAll",function(){var e={name:"curly"},n={name:"moe",getName:function(){return"name: "+this.name},sayHi:function(){return"hi: "+this.name}};e.getName=n.getName,_.bindAll(n,"getName","sayHi"),e.sayHi=n.sayHi,equals(e.getName(),"name: curly","unbound function is bound to current object"),equals(e.sayHi(),"hi: moe","bound function is still bound to original object"),e={name:"curly"},n={name:"moe",getName:function(){return"name: "+this.name},sayHi:function(){return"hi: "+this.name}},_.bindAll(n),e.sayHi=n.sayHi,equals(e.sayHi(),"hi: moe","calling bindAll with no arguments binds all functions to the object")}),test("functions: memoize",function(){var e=function(n){return 2>n?n:e(n-1)+e(n-2)},n=_.memoize(e);equals(e(10),55,"a memoized version of fibonacci produces identical results"),equals(n(10),55,"a memoized version of fibonacci produces identical results");var t=function(e){return e},r=_.memoize(t);equals(t("toString"),"toString","checks hasOwnProperty"),equals(r("toString"),"toString","checks hasOwnProperty")}),asyncTest("functions: delay",2,function(){var e=!1;_.delay(function(){e=!0},100),setTimeout(function(){ok(!e,"didn't delay the function quite yet")},50),setTimeout(function(){ok(e,"delayed the function"),start()},150)}),asyncTest("functions: defer",1,function(){var e=!1;_.defer(function(n){e=n},!0),_.delay(function(){ok(e,"deferred the function"),start()},50)}),asyncTest("functions: throttle",2,function(){var e=0,n=function(){e++},t=_.throttle(n,100);t(),t(),t(),setTimeout(t,70),setTimeout(t,120),setTimeout(t,140),setTimeout(t,190),setTimeout(t,220),setTimeout(t,240),_.delay(function(){ok(1==e,"incr was called immediately")},30),_.delay(function(){ok(4==e,"incr was throttled"),start()},400)}),asyncTest("functions: throttle arguments",2,function(){var e=0,n=function(n){e=n},t=_.throttle(n,100);t(1),t(2),t(3),setTimeout(function(){t(4)},120),setTimeout(function(){t(5)},140),setTimeout(function(){t(6)},250),_.delay(function(){equals(e,1,"updated to latest value")},40),_.delay(function(){equals(e,6,"updated to latest value"),start()},400)}),asyncTest("functions: throttle once",1,function(){var e=0,n=function(){e++},t=_.throttle(n,100);t(),_.delay(function(){ok(1==e,"incr was called once"),start()},220)}),asyncTest("functions: throttle twice",1,function(){var e=0,n=function(){e++},t=_.throttle(n,100);t(),t(),_.delay(function(){ok(2==e,"incr was called twice"),start()},220)}),asyncTest("functions: debounce",1,function(){var e=0,n=function(){e++},t=_.debounce(n,50);t(),t(),t(),setTimeout(t,30),setTimeout(t,60),setTimeout(t,90),setTimeout(t,120),setTimeout(t,150),_.delay(function(){ok(1==e,"incr was debounced"),start()},220)}),test("functions: once",function(){var e=0,n=_.once(function(){e++});n(),n(),equals(e,1)}),test("functions: wrap",function(){var e=function(e){return"hi: "+e},n=_.wrap(e,function(e,n){return e(n)+" "+n.split("").reverse().join("")});equals(n("moe"),"hi: moe eom","wrapped the saluation function");var t=function(){return"Hello "},r={name:"Moe"};r.hi=_.wrap(t,function(e){return e()+this.name}),equals(r.hi(),"Hello Moe");var a=function(){},i=_.wrap(a,function(e){return Array.prototype.slice.call(arguments,0)}),o=i(["whats","your"],"vector","victor");same(o,[a,["whats","your"],"vector","victor"])}),test("functions: compose",function(){var e=function(e){return"hi: "+e},n=function(e){return e+"!"},t=_.compose(n,e);equals(t("moe"),"hi: moe!","can compose a function that takes another"),t=_.compose(e,n),equals(t("moe"),"hi: moe!","in this case, the functions are also commutative")}),test("functions: after",function(){var e=function(e,n){for(var t=0,r=_.after(e,function(){t++});n--;)r();return t};equals(e(5,5),1,"after(N) should fire after being called N times"),equals(e(5,4),0,"after(N) should not fire unless called N times"),equals(e(0,0),1,"after(0) should fire immediately")})});