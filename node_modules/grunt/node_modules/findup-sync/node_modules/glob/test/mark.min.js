var test=require("tap").test,glob=require("../");process.chdir(__dirname);var lag=5;glob.Glob.prototype._stat=function(e){return function(n,t){arguments;setTimeout(function(){e.call(this,n,t)}.bind(this),lag+=5)}}(glob.Glob.prototype._stat),test("mark, with **",function(e){glob("a/*b*/**",{mark:!0},function(n,t){if(n)throw n;var r=["a/abcdef/","a/abcdef/g/","a/abcdef/g/h","a/abcfed/","a/abcfed/g/","a/abcfed/g/h","a/b/","a/b/c/","a/b/c/d","a/bc/","a/bc/e/","a/bc/e/f","a/cb/","a/cb/e/","a/cb/e/f"];e.same(t,r),e.end()})}),test("mark, no / on pattern",function(e){glob("a/*",{mark:!0},function(n,t){if(n)throw n;var r=["a/abcdef/","a/abcfed/","a/b/","a/bc/","a/c/","a/cb/"];"win32"!==process.platform&&r.push("a/symlink/"),e.same(t,r),e.end()}).on("match",function(n){e.similar(n,/\/$/)})}),test("mark=false, no / on pattern",function(e){glob("a/*",function(n,t){if(n)throw n;var r=["a/abcdef","a/abcfed","a/b","a/bc","a/c","a/cb"];"win32"!==process.platform&&r.push("a/symlink"),e.same(t,r),e.end()}).on("match",function(n){e.similar(n,/[^\/]$/)})}),test("mark=true, / on pattern",function(e){glob("a/*/",{mark:!0},function(n,t){if(n)throw n;var r=["a/abcdef/","a/abcfed/","a/b/","a/bc/","a/c/","a/cb/"];"win32"!==process.platform&&r.push("a/symlink/"),e.same(t,r),e.end()}).on("match",function(n){e.similar(n,/\/$/)})}),test("mark=false, / on pattern",function(e){glob("a/*/",function(n,t){if(n)throw n;var r=["a/abcdef/","a/abcfed/","a/b/","a/bc/","a/c/","a/cb/"];"win32"!==process.platform&&r.push("a/symlink/"),e.same(t,r),e.end()}).on("match",function(n){e.similar(n,/\/$/)})});