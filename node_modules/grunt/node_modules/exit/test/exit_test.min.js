"use strict";function which(e){try{return _which(e),e}catch(n){return!1}}function normalizeLineEndings(e){return e.replace(/\r?\n/g,"\n")}function run(e,n){exec(e,function(e,t){n(e?e.code:0,normalizeLineEndings(t))})}function fixture(e){return normalizeLineEndings(String(fs.readFileSync(e)))}function buildTests(){var e=[10,100,1e3],n=[" stdout stderr"," stdout"," stderr"],t=[""," | "+grep+' "std"'];e.forEach(function(e){n.forEach(function(n){t.forEach(function(t){var r="node log.js 0 "+e+n+" 2>&1"+t;exports.exit["output ("+r+")"]=function(t){t.expect(2),run(r,function(r,a){var i=fixture(e+n.replace(/ /g,"-")+".txt");t.equal(a.length,i.length,"should be the same length."),t.ok(-1===a.indexOf("fail"),"should not output after exit is called."),t.done()})}})})});var r=[0,1,123];r.forEach(function(e){var n="node log.js "+e+" 10 stdout stderr";exports.exit["exit code ("+n+")"]=function(t){t.expect(1),run(n,function(n){t.equal(n,e,"should exit with "+e+" error code."),t.done()})}})}var fs=require("fs"),exec=require("child_process").exec,_which=require("which").sync,grep=which("grep")||"win32"===process.platform&&which("find");exports.exit={setUp:function(e){this.origCwd=process.cwd(),process.chdir("test/fixtures"),e()},tearDown:function(e){process.chdir(this.origCwd),e()},grep:function(e){e.expect(1),e.ok(grep,'A suitable "grep" or "find" program was not found in the PATH.'),e.done()}},grep&&buildTests();