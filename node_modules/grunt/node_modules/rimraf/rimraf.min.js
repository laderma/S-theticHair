function defaults(e){var n=["unlink","chmod","stat","rmdir","readdir"];n.forEach(function(n){e[n]=e[n]||fs[n],n+="Sync",e[n]=e[n]||fs[n]})}function rimraf(e,n,t){if("function"==typeof n&&(t=n,n={}),assert(e),assert(n),assert("function"==typeof t),defaults(n),!t)throw new Error("No callback passed to rimraf()");var r=0;rimraf_(e,n,function a(i){if(i){if(isWindows&&("EBUSY"===i.code||"ENOTEMPTY"===i.code)&&r<exports.BUSYTRIES_MAX){r++;var s=100*r;return setTimeout(function(){rimraf_(e,n,a)},s)}if("EMFILE"===i.code&&timeout<exports.EMFILE_MAX)return setTimeout(function(){rimraf_(e,n,a)},timeout++);"ENOENT"===i.code&&(i=null)}timeout=0,t(i)})}function rimraf_(e,n,t){assert(e),assert(n),assert("function"==typeof t),n.unlink(e,function(r){if(r){if("ENOENT"===r.code)return t(null);if("EPERM"===r.code)return isWindows?fixWinEPERM(e,n,r,t):rmdir(e,n,r,t);if("EISDIR"===r.code)return rmdir(e,n,r,t)}return t(r)})}function fixWinEPERM(e,n,t,r){assert(e),assert(n),assert("function"==typeof r),t&&assert(t instanceof Error),n.chmod(e,666,function(a){a?r("ENOENT"===a.code?null:t):n.stat(e,function(a,i){a?r("ENOENT"===a.code?null:t):i.isDirectory()?rmdir(e,n,t,r):n.unlink(e,r)})})}function fixWinEPERMSync(e,n,t){assert(e),assert(n),t&&assert(t instanceof Error);try{n.chmodSync(e,666)}catch(r){if("ENOENT"===r.code)return;throw t}try{var a=n.statSync(e)}catch(i){if("ENOENT"===i.code)return;throw t}a.isDirectory()?rmdirSync(e,n,t):n.unlinkSync(e)}function rmdir(e,n,t,r){assert(e),assert(n),t&&assert(t instanceof Error),assert("function"==typeof r),n.rmdir(e,function(a){!a||"ENOTEMPTY"!==a.code&&"EEXIST"!==a.code&&"EPERM"!==a.code?r(a&&"ENOTDIR"===a.code?t:a):rmkids(e,n,r)})}function rmkids(e,n,t){assert(e),assert(n),assert("function"==typeof t),n.readdir(e,function(r,a){if(r)return t(r);var i=a.length;if(0===i)return n.rmdir(e,t);var s;a.forEach(function(r){rimraf(path.join(e,r),n,function(r){return s?void 0:r?t(s=r):void(0===--i&&n.rmdir(e,t))})})})}function rimrafSync(e,n){n=n||{},defaults(n),assert(e),assert(n);try{n.unlinkSync(e)}catch(t){if("ENOENT"===t.code)return;if("EPERM"===t.code)return isWindows?fixWinEPERMSync(e,n,t):rmdirSync(e,n,t);if("EISDIR"!==t.code)throw t;rmdirSync(e,n,t)}}function rmdirSync(e,n,t){assert(e),assert(n),t&&assert(t instanceof Error);try{n.rmdirSync(e)}catch(r){if("ENOENT"===r.code)return;if("ENOTDIR"===r.code)throw t;("ENOTEMPTY"===r.code||"EEXIST"===r.code||"EPERM"===r.code)&&rmkidsSync(e,n)}}function rmkidsSync(e,n){assert(e),assert(n),n.readdirSync(e).forEach(function(t){rimrafSync(path.join(e,t),n)}),n.rmdirSync(e,n)}module.exports=rimraf,rimraf.sync=rimrafSync;var assert=require("assert"),path=require("path"),fs=require("fs"),timeout=0;exports.EMFILE_MAX=1e3,exports.BUSYTRIES_MAX=3;var isWindows="win32"===process.platform;