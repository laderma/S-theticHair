"use strict";var util=require("util"),format=require("util").format,_=require("underscore"),Action=require("../action"),$$=require("../const"),argumentErrorHelper=require("../argument/error"),ChoicesPseudoAction=function(e,n){var t={optionStrings:[],dest:e,help:n};Action.call(this,t)};util.inherits(ChoicesPseudoAction,Action);var ActionSubparsers=module.exports=function(e){e=e||{},e.dest=e.dest||$$.SUPPRESS,e.nargs=$$.PARSER,this.debug=e.debug===!0,this._progPrefix=e.prog,this._parserClass=e.parserClass,this._nameParserMap={},this._choicesActions=[],e.choices=this._nameParserMap,Action.call(this,e)};util.inherits(ActionSubparsers,Action),ActionSubparsers.prototype.addParser=function(e,n){var t,r=this;n=n||{},n.debug=this.debug===!0,n.prog||(n.prog=this._progPrefix+" "+e);var i=n.aliases||[];if(n.help||_.isString(n.help)){var a=n.help;delete n.help;var o=new ChoicesPseudoAction(e,a);this._choicesActions.push(o)}return t=new this._parserClass(n),this._nameParserMap[e]=t,i.forEach(function(e){r._nameParserMap[e]=t}),t},ActionSubparsers.prototype._getSubactions=function(){return this._choicesActions},ActionSubparsers.prototype.call=function(e,n,t){var r=t[0],i=t.slice(1);if(this.dest!==$$.SUPPRESS&&(n[this.dest]=r),!this._nameParserMap[r])throw argumentErrorHelper(format('Unknown parser "%s" (choices: [%s]).',r,_.keys(this._nameParserMap).join(", ")));e=this._nameParserMap[r],e.parseArgs(i,n)};