"use strict";function kindOf(e){var n=typeof e;return null===e?"null":"number"===n?0===e%1?"integer":"float":"object"===n&&Array.isArray(e)?"array":n}function compileStyleMap(e,n){var t,r,a,i,o,s,u;if(null===n)return{};for(t={},r=Object.keys(n),a=0,i=r.length;i>a;a+=1)o=r[a],s=String(n[o]),"!!"===o.slice(0,2)&&(o="tag:yaml.org,2002:"+o.slice(2)),u=e.compiledTypeMap[o],u&&u.dumper&&_hasOwnProperty.call(u.dumper.styleAliases,s)&&(s=u.dumper.styleAliases[s]),t[o]=s;return t}function encodeHex(e){var n,t,r;if(n=e.toString(16).toUpperCase(),255>=e)t="x",r=2;else if(65535>=e)t="u",r=4;else{if(!(4294967295>=e))throw new YAMLException("code point within a string may not be greater than 0xFFFFFFFF");t="U",r=8}return"\\"+t+common.repeat("0",r-n.length)+n}function dump(e,n){function f(e){return"\n"+common.repeat(" ",r*e)}function d(e){var n,t,r;for(n=0,t=o.length;t>n;n+=1)if(r=o[n],null!==r.loader&&NIL!==r.loader.resolver(e,!1))return!0;return!1}function h(e){var n,t,r,a,i;for(c="",n=!1,t=0,(0===e.length||CHAR_SPACE===e.charCodeAt(0)||CHAR_SPACE===e.charCodeAt(e.length-1))&&(n=!0),r=0,a=e.length;a>r;r+=1)i=e.charCodeAt(r),n||(CHAR_TAB===i||CHAR_LINE_FEED===i||CHAR_CARRIAGE_RETURN===i||CHAR_COMMA===i||CHAR_LEFT_SQUARE_BRACKET===i||CHAR_RIGHT_SQUARE_BRACKET===i||CHAR_LEFT_CURLY_BRACKET===i||CHAR_RIGHT_CURLY_BRACKET===i||CHAR_SHARP===i||CHAR_AMPERSAND===i||CHAR_ASTERISK===i||CHAR_EXCLAMATION===i||CHAR_VERTICAL_LINE===i||CHAR_GREATER_THAN===i||CHAR_SINGLE_QUOTE===i||CHAR_DOUBLE_QUOTE===i||CHAR_PERCENT===i||CHAR_COMMERCIAL_AT===i||CHAR_GRAVE_ACCENT===i||CHAR_QUESTION===i||CHAR_COLON===i||CHAR_MINUS===i)&&(n=!0),(ESCAPE_SEQUENCES[i]||!(i>=32&&126>=i||133===i||i>=160&&55295>=i||i>=57344&&65533>=i||i>=65536&&1114111>=i))&&(c+=e.slice(t,r),c+=ESCAPE_SEQUENCES[i]||encodeHex(i),t=r+1,n=!0);r>t&&(c+=e.slice(t,r)),!n&&d(c)&&(n=!0),n&&(c='"'+c+'"')}function p(e,n){var a,i,t="",r=l;for(a=0,i=n.length;i>a;a+=1)0!==a&&(t+=", "),_(e,n[a],!1,!1),t+=c;l=r,c="["+t+"]"}function m(e,n,t){var i,o,r="",a=l;for(i=0,o=n.length;o>i;i+=1)t&&0===i||(r+=f(e)),_(e+1,n[i],!0,!0),r+="- "+c;l=a,c=r}function g(e,n){var i,o,s,u,t="",r=l,a=Object.keys(n);for(i=0,o=a.length;o>i;i+=1)0!==i&&(t+=", "),s=a[i],u=n[s],_(e,s,!1,!1),c.length>1024&&(t+="? "),t+=c+": ",_(e,u,!1,!1),t+=c;l=r,c="{"+t+"}"}function v(e,n,t){var o,s,u,d,h,r="",a=l,i=Object.keys(n);for(o=0,s=i.length;s>o;o+=1)t&&0===o||(r+=f(e)),u=i[o],d=n[u],_(e+1,u,!0,!0),h=null!==l&&"?"!==l&&c.length<=1024,h&&(r+="? "),r+=c,h&&(r+=f(e)),_(e+1,d,!0,h),r+=": "+c;l=a,c=r}function b(e,n){var t,r,a,f,d,h;for(r=n?s:o,u=kindOf(e),a=0,f=r.length;f>a;a+=1)if(d=r[a],null!==d.dumper&&(null===d.dumper.kind||u===d.dumper.kind)&&(null===d.dumper.instanceOf||e instanceof d.dumper.instanceOf)&&(null===d.dumper.predicate||d.dumper.predicate(e))){if(l=n?d.tag:"?",null!==d.dumper.representer){if(h=i[d.tag]||d.dumper.defaultStyle,"function"==typeof d.dumper.representer)t=d.dumper.representer(e,h);else{if(!_hasOwnProperty.call(d.dumper.representer,h))throw new YAMLException("!<"+d.tag+'> tag resolver accepts not "'+h+'" style');t=d.dumper.representer[h](e,h)}if(NIL===t){if(n)throw new YAMLException("cannot represent an object of !<"+d.tag+"> type");continue}u=kindOf(t),c=t}return!0}return!1}function _(e,n,t,i){if(l=null,c=n,b(n,!1)||b(n,!0),t&&(t=0>a||a>e),(null!==l&&"?"!==l||2!==r&&e>0)&&(i=!1),"object"===u)t&&0!==Object.keys(c).length?v(e,c,i):g(e,c);else if("array"===u)t&&0!==c.length?m(e,c,i):p(e,c);else{if("string"!==u)throw new YAMLException("unacceptabe kind of an object to dump ("+u+")");"?"!==l&&h(c)}null!==l&&"?"!==l&&(c="!<"+l+"> "+c)}n=n||{};var u,l,c,t=n.schema||DEFAULT_SCHEMA,r=Math.max(1,n.indent||2),a=common.isNothing(n.flowLevel)?-1:n.flowLevel,i=compileStyleMap(t,n.styles||null),o=t.compiledImplicit,s=t.compiledExplicit;return _(0,e,!0,!0),c+"\n"}function safeDump(e,n){return dump(e,common.extend({schema:SAFE_SCHEMA},n))}var common=require("./common"),NIL=common.NIL,YAMLException=require("./exception"),DEFAULT_SCHEMA=require("./schema/default"),SAFE_SCHEMA=require("./schema/safe"),_hasOwnProperty=Object.prototype.hasOwnProperty,CHAR_TAB=9,CHAR_LINE_FEED=10,CHAR_CARRIAGE_RETURN=13,CHAR_SPACE=32,CHAR_EXCLAMATION=33,CHAR_DOUBLE_QUOTE=34,CHAR_SHARP=35,CHAR_PERCENT=37,CHAR_AMPERSAND=38,CHAR_SINGLE_QUOTE=39,CHAR_ASTERISK=42,CHAR_COMMA=44,CHAR_MINUS=45,CHAR_COLON=58,CHAR_GREATER_THAN=62,CHAR_QUESTION=63,CHAR_COMMERCIAL_AT=64,CHAR_LEFT_SQUARE_BRACKET=91,CHAR_RIGHT_SQUARE_BRACKET=93,CHAR_GRAVE_ACCENT=96,CHAR_LEFT_CURLY_BRACKET=123,CHAR_VERTICAL_LINE=124,CHAR_RIGHT_CURLY_BRACKET=125,ESCAPE_SEQUENCES={};ESCAPE_SEQUENCES[0]="\\0",ESCAPE_SEQUENCES[7]="\\a",ESCAPE_SEQUENCES[8]="\\b",ESCAPE_SEQUENCES[9]="\\t",ESCAPE_SEQUENCES[10]="\\n",ESCAPE_SEQUENCES[11]="\\v",ESCAPE_SEQUENCES[12]="\\f",ESCAPE_SEQUENCES[13]="\\r",ESCAPE_SEQUENCES[27]="\\e",ESCAPE_SEQUENCES[34]='\\"',ESCAPE_SEQUENCES[92]="\\\\",ESCAPE_SEQUENCES[133]="\\N",ESCAPE_SEQUENCES[160]="\\_",ESCAPE_SEQUENCES[8232]="\\L",ESCAPE_SEQUENCES[8233]="\\P",module.exports.dump=dump,module.exports.safeDump=safeDump;