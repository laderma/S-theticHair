function glob(e,n,t){if("function"==typeof n&&(t=n,n={}),n||(n={}),"number"==typeof n)return void deprecated();var r=new Glob(e,n,t);return r.sync?r.found:r}function deprecated(){throw new Error("glob's interface has changed. Please see the docs.")}function globSync(e,n){return"number"==typeof n?void deprecated():(n=n||{},n.sync=!0,glob(e,n))}function Glob(e,n,t){function s(e,n,t){this._process(e,0,n,function(e){e&&this.emit("error",e),--i<=0&&this._finish()})}if(!(this instanceof Glob))return new Glob(e,n,t);"function"==typeof t&&(this.on("error",t),this.on("end",function(e){t(null,e)})),n=n||{},this.EOF={},this._emitQueue=[],this.maxDepth=n.maxDepth||1e3,this.maxLength=n.maxLength||1/0,this.statCache=n.statCache||{},this.changedCwd=!1;var r=process.cwd();if(n.hasOwnProperty("cwd")?(this.cwd=n.cwd,this.changedCwd=path.resolve(n.cwd)!==r):this.cwd=r,this.root=n.root||path.resolve(this.cwd,"/"),this.root=path.resolve(this.root),"win32"===process.platform&&(this.root=this.root.replace(/\\/g,"/")),this.nomount=!!n.nomount,!e)throw new Error("must provide pattern");if(n.matchBase&&-1===e.indexOf("/")){if(n.noglobstar)throw new Error("base matching requires globstar");e="**/"+e}this.strict=n.strict!==!1,this.dot=!!n.dot,this.mark=!!n.mark,this.sync=!!n.sync,this.nounique=!!n.nounique,this.nonull=!!n.nonull,this.nosort=!!n.nosort,this.nocase=!!n.nocase,this.stat=!!n.stat,this.debug=!!n.debug||!!n.globDebug,this.debug&&(this.log=console.error),this.silent=!!n.silent;var a=this.minimatch=new Minimatch(e,n);this.options=a.options,e=this.pattern=a.pattern,this.error=null,this.aborted=!1,EE.call(this);var i=this.minimatch.set.length;this.matches=new Array(i),this.minimatch.set.forEach(s.bind(this))}function alphasorti(e,n){return e=e.toLowerCase(),n=n.toLowerCase(),alphasort(e,n)}function alphasort(e,n){return e>n?1:n>e?-1:0}function absWin(e){if(absUnix(e))return!0;var n=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,t=n.exec(e),r=t[1]||"",a=r&&":"!==r.charAt(1),i=!!t[2]||a;return i}function absUnix(e){return"/"===e.charAt(0)||""===e}module.exports=glob;var fs=require("graceful-fs"),minimatch=require("minimatch"),Minimatch=minimatch.Minimatch,inherits=require("inherits"),EE=require("events").EventEmitter,path=require("path"),isDir={},assert=require("assert").ok;glob.fnmatch=deprecated,glob.sync=globSync,glob.Glob=Glob,inherits(Glob,EE),Glob.prototype.log=function(){},Glob.prototype._finish=function(){assert(this instanceof Glob);for(var e=this.nounique,n=e?[]:{},t=0,r=this.matches.length;r>t;t++){var a=this.matches[t];if(this.log("matches[%d] =",t,a),a){var s=Object.keys(a);e?n.push.apply(n,s):s.forEach(function(e){n[e]=!0})}else if(this.nonull){var i=this.minimatch.globSet[t];e?n.push(i):n[i]=!0}}e||(n=Object.keys(n)),this.nosort||(n=n.sort(this.nocase?alphasorti:alphasort)),this.mark&&(n=n.map(function(e){var n=this.statCache[e];if(!n)return e;var t=Array.isArray(n)||2===n;return t&&"/"!==e.slice(-1)?e+"/":t||"/"!==e.slice(-1)?e:e.replace(/\/+$/,"")},this)),this.log("emitting end",n),this.EOF=this.found=n,this.emitMatch(this.EOF)},Glob.prototype.abort=function(){this.aborted=!0,this.emit("abort")},Glob.prototype.pause=function(){this.paused||(this.sync&&this.emit("error",new Error("Can't pause/resume sync glob")),this.paused=!0,this.emit("pause"))},Glob.prototype.resume=function(){this.paused&&(this.sync&&this.emit("error",new Error("Can't pause/resume sync glob")),this.paused=!1,this.emit("resume"),this._processEmitQueue())},Glob.prototype.emitMatch=function(e){this._emitQueue.push(e),this._processEmitQueue()},Glob.prototype._processEmitQueue=function(e){for(;!this._processingEmitQueue&&!this.paused;){this._processingEmitQueue=!0;var e=this._emitQueue.shift();if(!e){this._processingEmitQueue=!1;break}this.log("emit!",e===this.EOF?"end":"match"),this.emit(e===this.EOF?"end":"match",e),this._processingEmitQueue=!1}},Glob.prototype._process=function(e,n,t,r){assert(this instanceof Glob);var a=function(e,n){assert(this instanceof Glob),this.paused?(this._processQueue||(this._processQueue=[],this.once("resume",function(){var e=this._processQueue;this._processQueue=null,e.forEach(function(e){e()})})),this._processQueue.push(r.bind(this,e,n))):r.call(this,e,n)}.bind(this);if(this.aborted)return a();if(n>this.maxDepth)return a();for(var i=0;"string"==typeof e[i];)i++;var s;switch(i){case e.length:return s=e.join("/"),void this._stat(s,function(e,n){return e&&(s&&isAbsolute(s)&&!this.nomount&&(s="/"===s.charAt(0)?path.join(this.root,s):path.resolve(this.root,s)),"win32"===process.platform&&(s=s.replace(/\\/g,"/")),this.matches[t]=this.matches[t]||{},this.matches[t][s]=!0,this.emitMatch(s)),a()});case 0:s=null;break;default:s=e.slice(0,i),s=s.join("/")}var o;return null===s?o=".":isAbsolute(s)||isAbsolute(e.join("/"))?(s&&isAbsolute(s)||(s=path.join("/",s)),o=s=path.resolve(s),this.log("absolute: ",s,this.root,e,o)):o=s,this.log("readdir(%j)",o,this.cwd,this.root),this._readdir(o,function(r,o){if(r)return a();if(e[i]===minimatch.GLOBSTAR){var l=[e.slice(0,i).concat(e.slice(i+1))];o.forEach(function(n){("."!==n.charAt(0)||this.dot)&&(l.push(e.slice(0,i).concat(n).concat(e.slice(i+1))),l.push(e.slice(0,i).concat(n).concat(e.slice(i))))},this);var u=l.length,c=null;return void l.forEach(function(e){this._process(e,n+1,t,function(e){return c?void 0:e?a(c=e):--u<=0?a():void 0})},this)}var d=e[i];if("string"==typeof d){var f=-1!==o.indexOf(d);o=f?o[d]:[]}else{var h=e[i]._glob,m=this.dot||"."===h.charAt(0);o=o.filter(function(n){return("."!==n.charAt(0)||m)&&("string"==typeof e[i]&&n===e[i]||n.match(e[i]))})}if(i===e.length-1&&!this.mark&&!this.stat)return o.forEach(function(e){s&&(e="/"!==s?s+"/"+e:s+e),"/"!==e.charAt(0)||this.nomount||(e=path.join(this.root,e)),"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this.matches[t]=this.matches[t]||{},this.matches[t][e]=!0,this.emitMatch(e)},this),a.call(this);var u=o.length,c=null;return 0===u?a():void o.forEach(function(r){var s=e.slice(0,i).concat(r).concat(e.slice(i+1));this._process(s,n+1,t,function(e){return c?void 0:e?a(c=e):0===--u?a.call(this):void 0})},this)})},Glob.prototype._stat=function(e,n){assert(this instanceof Glob);var t=e;if("/"===e.charAt(0)?t=path.join(this.root,e):this.changedCwd&&(t=path.resolve(this.cwd,e)),this.log("stat",[this.cwd,e,"=",t]),e.length>this.maxLength){var r=new Error("Path name too long");return r.code="ENAMETOOLONG",r.path=e,this._afterStat(e,t,n,r)}if(this.statCache.hasOwnProperty(e)){var a=this.statCache[e],i=a&&(Array.isArray(a)||2===a);return this.sync?n.call(this,!!a,i):process.nextTick(n.bind(this,!!a,i))}if(this.sync){var r,s;try{s=fs.statSync(t)}catch(o){r=o}this._afterStat(e,t,n,r,s)}else fs.stat(t,this._afterStat.bind(this,e,t,n))},Glob.prototype._afterStat=function(e,n,t,r,a){var i;assert(this instanceof Glob),"/"===n.slice(-1)&&a&&!a.isDirectory()&&(this.log("should be ENOTDIR, fake it"),r=new Error("ENOTDIR, not a directory '"+n+"'"),r.path=n,r.code="ENOTDIR",a=null),i=r||!a?!1:a.isDirectory()?2:1,this.statCache[e]=this.statCache[e]||i,t.call(this,!!i,2===i)},Glob.prototype._readdir=function(e,n){assert(this instanceof Glob);var t=e;if("/"===e.charAt(0)?t=path.join(this.root,e):isAbsolute(e)?t=e:this.changedCwd&&(t=path.resolve(this.cwd,e)),this.log("readdir",[this.cwd,e,t]),e.length>this.maxLength){var r=new Error("Path name too long");return r.code="ENAMETOOLONG",r.path=e,this._afterReaddir(e,t,n,r)}if(this.statCache.hasOwnProperty(e)){var a=this.statCache[e];if(Array.isArray(a))return this.sync?n.call(this,null,a):process.nextTick(n.bind(this,null,a));if(!a||1===a){var i=a?"ENOTDIR":"ENOENT",r=new Error((a?"Not a directory":"Not found")+": "+e);return r.path=e,r.code=i,this.log(e,r),this.sync?n.call(this,r):process.nextTick(n.bind(this,r))}}if(this.sync){var r,s;try{s=fs.readdirSync(t)}catch(o){r=o}return this._afterReaddir(e,t,n,r,s)}fs.readdir(t,this._afterReaddir.bind(this,e,t,n))},Glob.prototype._afterReaddir=function(e,n,t,r,a){if(assert(this instanceof Glob),a&&!r)return this.statCache[e]=a,this.mark||this.stat||a.forEach(function(n){n="/"===e?e+n:e+"/"+n,this.statCache[n]=!0},this),t.call(this,r,a);if(r)switch(r.code){case"ENOTDIR":return this.statCache[e]=1,t.call(this,r);case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":return this.statCache[e]=!1,t.call(this,r);default:return this.statCache[e]=!1,this.strict&&this.emit("error",r),this.silent||console.error("glob error",r),t.call(this,r)}};var isAbsolute="win32"===process.platform?absWin:absUnix;