var test=require("tap").test,fs=require("../graceful-fs.js");test("graceful fs is not fs",function(e){e.notEqual(fs,require("fs")),e.end()}),test("open an existing file works",function(e){var n=fs._curOpen,t=fs.openSync(__filename,"r");e.equal(fs._curOpen,n+1),fs.closeSync(t),e.equal(fs._curOpen,n),fs.open(__filename,"r",function(t,r){if(t)throw t;e.equal(fs._curOpen,n+1),fs.close(r,function(t){if(t)throw t;e.equal(fs._curOpen,n),e.end()})})}),test("open a non-existing file throws",function(e){var t,n=fs._curOpen;try{var r=fs.openSync("this file does not exist","r")}catch(i){t=i}e.ok(t,"should throw"),e.notOk(r,"should not get an fd"),e.equal(t.code,"ENOENT"),e.equal(fs._curOpen,n),fs.open("neither does this file","r",function(t,r){e.ok(t,"should throw"),e.notOk(r,"should not get an fd"),e.equal(t.code,"ENOENT"),e.equal(fs._curOpen,n),e.end()})});