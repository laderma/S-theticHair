"use strict";var StreamReader=function(){this._queue=[],this._queueSize=0,this._offset=0};StreamReader.prototype.put=function(e){e&&0!==e.length&&(e.copy||(e=new Buffer(e)),this._queue.push(e),this._queueSize+=e.length)},StreamReader.prototype.read=function(e){if(e>this._queueSize)return null;if(0===e)return new Buffer(0);this._queueSize-=e;var i,a,n=this._queue,t=e,r=n[0];if(r.length>=e)return r.length===e?n.shift():(a=r.slice(0,e),n[0]=r.slice(e),a);for(var o=0,s=n.length;s>o&&!(t<n[o].length);o++)t-=n[o].length;return i=n.splice(0,o),t>0&&n.length>0&&(i.push(n[0].slice(0,t)),n[0]=n[0].slice(t)),this._concat(i,e)},StreamReader.prototype.eachByte=function(e,n){for(var t,r,i;this._queue.length>0;){for(t=this._queue[0],r=t.length;this._offset<r;)i=this._offset,this._offset+=1,e.call(n,t[i]);this._offset=0,this._queue.shift()}},StreamReader.prototype._concat=function(e,n){if(Buffer.concat)return Buffer.concat(e,n);for(var t=new Buffer(n),r=0,i=0,a=e.length;a>i;i++)e[i].copy(t,r),r+=e[i].length;return t},module.exports=StreamReader;