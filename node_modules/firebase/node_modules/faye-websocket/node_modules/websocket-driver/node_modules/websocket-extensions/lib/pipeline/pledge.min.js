"use strict";var RingBuffer=require("./ring_buffer"),Pledge=function(){this._complete=!1,this._callbacks=new RingBuffer(Pledge.QUEUE_SIZE)};Pledge.QUEUE_SIZE=4,Pledge.all=function(e){var n=new Pledge,t=e.length,r=t;for(0===t&&n.done();r--;)e[r].then(function(){t-=1,0===t&&n.done()});return n},Pledge.prototype.then=function(e){this._complete?e():this._callbacks.push(e)},Pledge.prototype.done=function(){this._complete=!0;for(var n,e=this._callbacks;n=e.shift();)n()},module.exports=Pledge;