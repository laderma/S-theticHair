var mkdirp=require("../"),path=require("path"),fs=require("fs"),test=require("tap").test;test("async perm",function(n){n.plan(2);var e="/tmp/"+(Math.random()*(1<<30)).toString(16);mkdirp(e,493,function(t){t?n.fail(t):path.exists(e,function(t){t?fs.stat(e,function(e,t){e?n.fail(e):(n.equal(511&t.mode,493),n.ok(t.isDirectory(),"target not a directory"),n.end())}):n.fail("file not created")})})}),test("async root perm",function(n){mkdirp("/tmp",493,function(e){e&&n.fail(e),n.end()}),n.end()});