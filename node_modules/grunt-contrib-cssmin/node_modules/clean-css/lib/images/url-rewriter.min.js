var path=require("path"),url=require("url");module.exports={process:function(e,n){for(var t=[],r=0,a=0,i=0;a<e.length&&(r=e.indexOf("url(",a),-1!=r)&&(a=e.indexOf(")",r+4),-1!=a);){t.push(e.substring(i,r));var o=e.substring(r+4,a).replace(/['"]/g,"");t.push("url("+this._rebased(o,n)+")"),i=a+1}return t.length>0?t.join("")+e.substring(i,e.length):e},_rebased:function(e,n){var r,t="/"==e[0]||".css"==e.substring(e.length-4)||0===e.indexOf("data:")||null!==/^https?:\/\//.exec(e)||null!==/__\w+__/.exec(e);return t?e:/https?:\/\//.test(n.toBase)?url.resolve(n.toBase,e):(r=n.absolute?path.resolve(path.join(n.fromBase,e)).replace(n.toBase,""):path.relative(n.toBase,path.join(n.fromBase,e)),"win32"==process.platform?r.replace(/\\/g,"/"):r)}};