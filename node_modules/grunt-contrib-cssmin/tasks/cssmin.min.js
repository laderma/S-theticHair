"use strict";var path=require("path"),CleanCSS=require("clean-css"),chalk=require("chalk"),maxmin=require("maxmin");module.exports=function(n){var e=function(e,t){try{return new CleanCSS(t).minify(e)}catch(r){n.log.error(r),n.fail.warn("CSS minification failed.")}};n.registerMultiTask("cssmin","Minify CSS",function(){var t=this.options({report:"min"});this.files.forEach(function(r){var a=r.src.filter(function(e){return n.file.exists(e)?!0:(n.log.warn("Source file "+chalk.cyan(e)+" not found."),!1)}),i="",s=a.map(function(r){var a=n.file.read(r);return i+=a,t.relativeTo=path.dirname(r),e(a,t)}).join("");return 0===s.length?n.log.warn("Destination not written because minified CSS was empty."):(t.banner&&(s=t.banner+n.util.linefeed+s),n.file.write(r.dest,s),void n.log.writeln("File "+chalk.cyan(r.dest)+" created: "+maxmin(i,s,"gzip"===t.report)))})})};