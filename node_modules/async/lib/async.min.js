!function(){function a(n){var r=!1;return function(){if(r)throw new Error("Callback was already called.");r=!0,n.apply(e,arguments)}}var e,r,n={};e=this,null!=e&&(r=e.async),n.noConflict=function(){return e.async=r,n};var t=function(n,e){if(n.forEach)return n.forEach(e);for(var r=0;r<n.length;r+=1)e(n[r],r,n)},i=function(n,e){if(n.map)return n.map(e);var r=[];return t(n,function(n,a,t){r.push(e(n,a,t))}),r},s=function(n,e,r){return n.reduce?n.reduce(e,r):(t(n,function(n,a,t){r=e(r,n,a,t)}),r)},l=function(n){if(Object.keys)return Object.keys(n);var e=[];for(var r in n)n.hasOwnProperty(r)&&e.push(r);return e};"undefined"!=typeof process&&process.nextTick?(n.nextTick=process.nextTick,"undefined"!=typeof setImmediate?n.setImmediate=function(n){setImmediate(n)}:n.setImmediate=n.nextTick):"function"==typeof setImmediate?(n.nextTick=function(n){setImmediate(n)},n.setImmediate=n.nextTick):(n.nextTick=function(n){setTimeout(n,0)},n.setImmediate=n.nextTick),n.each=function(n,e,r){if(r=r||function(){},!n.length)return r();var i=0;t(n,function(t){e(t,a(function(e){e?(r(e),r=function(){}):(i+=1,i>=n.length&&r(null))}))})},n.forEach=n.each,n.eachSeries=function(n,e,r){if(r=r||function(){},!n.length)return r();var a=0,t=function(){e(n[a],function(e){e?(r(e),r=function(){}):(a+=1,a>=n.length?r(null):t())})};t()},n.forEachSeries=n.eachSeries,n.eachLimit=function(n,e,r,a){var t=o(e);t.apply(null,[n,r,a])},n.forEachLimit=n.eachLimit;var o=function(n){return function(e,r,a){if(a=a||function(){},!e.length||0>=n)return a();var t=0,i=0,s=0;!function l(){if(t>=e.length)return a();for(;n>s&&i<e.length;)i+=1,s+=1,r(e[i-1],function(n){n?(a(n),a=function(){}):(t+=1,s-=1,t>=e.length?a():l())})}()}},u=function(e){return function(){var r=Array.prototype.slice.call(arguments);return e.apply(null,[n.each].concat(r))}},h=function(n,e){return function(){var r=Array.prototype.slice.call(arguments);return e.apply(null,[o(n)].concat(r))}},c=function(e){return function(){var r=Array.prototype.slice.call(arguments);return e.apply(null,[n.eachSeries].concat(r))}},d=function(n,e,r,a){var t=[];e=i(e,function(n,e){return{index:e,value:n}}),n(e,function(n,e){r(n.value,function(r,a){t[n.index]=a,e(r)})},function(n){a(n,t)})};n.map=u(d),n.mapSeries=c(d),n.mapLimit=function(n,e,r,a){return f(e)(n,r,a)};var f=function(n){return h(n,d)};n.reduce=function(e,r,a,t){n.eachSeries(e,function(n,e){a(r,n,function(n,a){r=a,e(n)})},function(n){t(n,r)})},n.inject=n.reduce,n.foldl=n.reduce,n.reduceRight=function(e,r,a,t){var s=i(e,function(n){return n}).reverse();n.reduce(s,r,a,t)},n.foldr=n.reduceRight;var g=function(n,e,r,a){var t=[];e=i(e,function(n,e){return{index:e,value:n}}),n(e,function(n,e){r(n.value,function(r){r&&t.push(n),e()})},function(n){a(i(t.sort(function(n,e){return n.index-e.index}),function(n){return n.value}))})};n.filter=u(g),n.filterSeries=c(g),n.select=n.filter,n.selectSeries=n.filterSeries;var m=function(n,e,r,a){var t=[];e=i(e,function(n,e){return{index:e,value:n}}),n(e,function(n,e){r(n.value,function(r){r||t.push(n),e()})},function(n){a(i(t.sort(function(n,e){return n.index-e.index}),function(n){return n.value}))})};n.reject=u(m),n.rejectSeries=c(m);var p=function(n,e,r,a){n(e,function(n,e){r(n,function(r){r?(a(n),a=function(){}):e()})},function(n){a()})};n.detect=u(p),n.detectSeries=c(p),n.some=function(e,r,a){n.each(e,function(n,e){r(n,function(n){n&&(a(!0),a=function(){}),e()})},function(n){a(!1)})},n.any=n.some,n.every=function(e,r,a){n.each(e,function(n,e){r(n,function(n){n||(a(!1),a=function(){}),e()})},function(n){a(!0)})},n.all=n.every,n.sortBy=function(e,r,a){n.map(e,function(n,e){r(n,function(r,a){r?e(r):e(null,{value:n,criteria:a})})},function(n,e){if(n)return a(n);var r=function(n,e){var r=n.criteria,a=e.criteria;return a>r?-1:r>a?1:0};a(null,i(e.sort(r),function(n){return n.value}))})},n.auto=function(e,r){r=r||function(){};var a=l(e);if(!a.length)return r(null);var i={},o=[],u=function(n){o.unshift(n)},h=function(n){for(var e=0;e<o.length;e+=1)if(o[e]===n)return void o.splice(e,1)},c=function(){t(o.slice(0),function(n){n()})};u(function(){l(i).length===a.length&&(r(null,i),r=function(){})}),t(a,function(a){var o=e[a]instanceof Function?[e[a]]:e[a],d=function(e){var s=Array.prototype.slice.call(arguments,1);if(s.length<=1&&(s=s[0]),e){var o={};t(l(i),function(n){o[n]=i[n]}),o[a]=s,r(e,o),r=function(){}}else i[a]=s,n.setImmediate(c)},f=o.slice(0,Math.abs(o.length-1))||[],g=function(){return s(f,function(n,e){return n&&i.hasOwnProperty(e)},!0)&&!i.hasOwnProperty(a)};if(g())o[o.length-1](d,i);else{var m=function(){g()&&(h(m),o[o.length-1](d,i))};u(m)}})},n.waterfall=function(e,r){if(r=r||function(){},e.constructor!==Array){var a=new Error("First argument to waterfall must be an array of functions");return r(a)}if(!e.length)return r();var t=function(e){return function(a){if(a)r.apply(null,arguments),r=function(){};else{var i=Array.prototype.slice.call(arguments,1),s=e.next();s?i.push(t(s)):i.push(r),n.setImmediate(function(){e.apply(null,i)})}}};t(n.iterator(e))()};var b=function(n,e,r){if(r=r||function(){},e.constructor===Array)n.map(e,function(n,e){n&&n(function(n){var r=Array.prototype.slice.call(arguments,1);r.length<=1&&(r=r[0]),e.call(null,n,r)})},r);else{var a={};n.each(l(e),function(n,r){e[n](function(e){var t=Array.prototype.slice.call(arguments,1);t.length<=1&&(t=t[0]),a[n]=t,r(e)})},function(n){r(n,a)})}};n.parallel=function(e,r){b({map:n.map,each:n.each},e,r)},n.parallelLimit=function(n,e,r){b({map:f(e),each:o(e)},n,r)},n.series=function(e,r){if(r=r||function(){},e.constructor===Array)n.mapSeries(e,function(n,e){n&&n(function(n){var r=Array.prototype.slice.call(arguments,1);r.length<=1&&(r=r[0]),e.call(null,n,r)})},r);else{var a={};n.eachSeries(l(e),function(n,r){e[n](function(e){var t=Array.prototype.slice.call(arguments,1);t.length<=1&&(t=t[0]),a[n]=t,r(e)})},function(n){r(n,a)})}},n.iterator=function(n){var e=function(r){var a=function(){return n.length&&n[r].apply(null,arguments),a.next()};return a.next=function(){return r<n.length-1?e(r+1):null},a};return e(0)},n.apply=function(n){var e=Array.prototype.slice.call(arguments,1);return function(){return n.apply(null,e.concat(Array.prototype.slice.call(arguments)))}};var H=function(n,e,r,a){var t=[];n(e,function(n,e){r(n,function(n,r){t=t.concat(r||[]),e(n)})},function(n){a(n,t)})};n.concat=u(H),n.concatSeries=c(H),n.whilst=function(e,r,a){e()?r(function(t){return t?a(t):void n.whilst(e,r,a)}):a()},n.doWhilst=function(e,r,a){e(function(t){return t?a(t):void(r()?n.doWhilst(e,r,a):a())})},n.until=function(e,r,a){e()?a():r(function(t){return t?a(t):void n.until(e,r,a)})},n.doUntil=function(e,r,a){e(function(t){return t?a(t):void(r()?a():n.doUntil(e,r,a))})},n.queue=function(e,r){function i(e,a,i,s){a.constructor!==Array&&(a=[a]),t(a,function(a){var t={data:a,callback:"function"==typeof s?s:null};i?e.tasks.unshift(t):e.tasks.push(t),e.saturated&&e.tasks.length===r&&e.saturated(),n.setImmediate(e.process)})}void 0===r&&(r=1);var s=0,l={tasks:[],concurrency:r,saturated:null,empty:null,drain:null,push:function(n,e){i(l,n,!1,e)},unshift:function(n,e){i(l,n,!0,e)},process:function(){if(s<l.concurrency&&l.tasks.length){var n=l.tasks.shift();l.empty&&0===l.tasks.length&&l.empty(),s+=1;var r=function(){s-=1,n.callback&&n.callback.apply(n,arguments),l.drain&&l.tasks.length+s===0&&l.drain(),l.process()},t=a(r);e(n.data,t)}},length:function(){return l.tasks.length},running:function(){return s}};return l},n.cargo=function(e,r){var a=!1,s=[],l={tasks:s,payload:r,saturated:null,empty:null,drain:null,push:function(e,a){e.constructor!==Array&&(e=[e]),t(e,function(n){s.push({data:n,callback:"function"==typeof a?a:null}),l.saturated&&s.length===r&&l.saturated()}),n.setImmediate(l.process)},process:function o(){if(!a){if(0===s.length)return void(l.drain&&l.drain());var n="number"==typeof r?s.splice(0,r):s.splice(0),u=i(n,function(n){return n.data});l.empty&&l.empty(),a=!0,e(u,function(){a=!1;var e=arguments;t(n,function(n){n.callback&&n.callback.apply(null,e)}),o()})}},length:function(){return s.length},running:function(){return a}};return l};var k=function(n){return function(e){var r=Array.prototype.slice.call(arguments,1);e.apply(null,r.concat([function(e){var r=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(e?console.error&&console.error(e):console[n]&&t(r,function(e){console[n](e)}))}]))}};n.log=k("log"),n.dir=k("dir"),n.memoize=function(n,e){var r={},a={};e=e||function(n){return n};var t=function(){var t=Array.prototype.slice.call(arguments),i=t.pop(),s=e.apply(null,t);s in r?i.apply(null,r[s]):s in a?a[s].push(i):(a[s]=[i],n.apply(null,t.concat([function(){r[s]=arguments;var n=a[s];delete a[s];for(var e=0,t=n.length;t>e;e++)n[e].apply(null,arguments)}])))};return t.memo=r,t.unmemoized=n,t},n.unmemoize=function(n){return function(){return(n.unmemoized||n).apply(null,arguments)}},n.times=function(e,r,a){for(var t=[],i=0;e>i;i++)t.push(i);return n.map(t,r,a)},n.timesSeries=function(e,r,a){for(var t=[],i=0;e>i;i++)t.push(i);return n.mapSeries(t,r,a)},n.compose=function(){var e=Array.prototype.reverse.call(arguments);return function(){var r=this,a=Array.prototype.slice.call(arguments),t=a.pop();n.reduce(e,a,function(n,e,a){e.apply(r,n.concat([function(){var n=arguments[0],e=Array.prototype.slice.call(arguments,1);a(n,e)}]))},function(n,e){t.apply(r,[n].concat(e))})}};var v=function(n,e){var r=function(){var r=this,a=Array.prototype.slice.call(arguments),t=a.pop();return n(e,function(n,e){n.apply(r,a.concat([e]))},t)};if(arguments.length>2){var a=Array.prototype.slice.call(arguments,2);return r.apply(this,a)}return r};n.applyEach=u(v),n.applyEachSeries=c(v),n.forever=function(n,e){function r(a){if(a){if(e)return e(a);throw a}n(r)}r()},"undefined"!=typeof define&&define.amd?define([],function(){return n}):"undefined"!=typeof module&&module.exports?module.exports=n:e.async=n}();