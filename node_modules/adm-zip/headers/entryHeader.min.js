var Utils=require("../util"),Constants=Utils.Constants;module.exports=function(){function p(n){var n=new Date(n);t=(n.getFullYear()-1980&127)<<25|n.getMonth()+1<<21|n.getDay()<<16|n.getHours()<<11|n.getMinutes()<<5|n.getSeconds()>>1}var n=10,e=10,r=0,a=0,t=0,i=0,s=0,l=0,o=0,u=0,h=0,c=0,d=0,f=0,g=0,m={};return p(+new Date),{get made(){return n},set made(e){n=e},get version(){return e},set version(n){e=n},get flags(){return r},set flags(n){r=n},get method(){return a},set method(n){a=n},get time(){return new Date((t>>25&127)+1980,(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1)},set time(n){p(n)},get crc(){return i},set crc(n){i=n},get compressedSize(){return s},set compressedSize(n){s=n},get size(){return l},set size(n){l=n},get fileNameLength(){return o},set fileNameLength(n){o=n},get extraLength(){return u},set extraLength(n){u=n},get commentLength(){return h},set commentLength(n){h=n},get diskNumStart(){return c},set diskNumStart(n){c=n},get inAttr(){return d},set inAttr(n){d=n},get attr(){return f},set attr(n){f=n},get offset(){return g},set offset(n){g=n},get encripted(){return 1==(1&r)},get entryHeaderSize(){return Constants.CENHDR+o+u+h},get realDataOffset(){return g+Constants.LOCHDR+m.fnameLen+m.extraLen},get dataHeader(){return m},loadDataHeaderFromBinary:function(n){var e=n.slice(g,g+Constants.LOCHDR);if(e.readUInt32LE(0)!=Constants.LOCSIG)throw Utils.Errors.INVALID_LOC;m={version:e.readUInt16LE(Constants.LOCVER),flags:e.readUInt16LE(Constants.LOCFLG),method:e.readUInt16LE(Constants.LOCHOW),time:e.readUInt32LE(Constants.LOCTIM),crc:e.readUInt32LE(Constants.LOCCRC),compressedSize:e.readUInt32LE(Constants.LOCSIZ),size:e.readUInt32LE(Constants.LOCLEN),fnameLen:e.readUInt16LE(Constants.LOCNAM),extraLen:e.readUInt16LE(Constants.LOCEXT)}},loadFromBinary:function(m){if(m.length!=Constants.CENHDR||m.readUInt32LE(0)!=Constants.CENSIG)throw Utils.Errors.INVALID_CEN;n=m.readUInt16LE(Constants.CENVEM),e=m.readUInt16LE(Constants.CENVER),r=m.readUInt16LE(Constants.CENFLG),a=m.readUInt16LE(Constants.CENHOW),t=m.readUInt32LE(Constants.CENTIM),i=m.readUInt32LE(Constants.CENCRC),s=m.readUInt32LE(Constants.CENSIZ),l=m.readUInt32LE(Constants.CENLEN),o=m.readUInt16LE(Constants.CENNAM),u=m.readUInt16LE(Constants.CENEXT),h=m.readUInt16LE(Constants.CENCOM),c=m.readUInt16LE(Constants.CENDSK),d=m.readUInt16LE(Constants.CENATT),f=m.readUInt32LE(Constants.CENATX),g=m.readUInt32LE(Constants.CENOFF)},dataHeaderToBinary:function(){var n=new Buffer(Constants.LOCHDR);return n.writeUInt32LE(Constants.LOCSIG,0),n.writeUInt16LE(e,Constants.LOCVER),n.writeUInt16LE(r,Constants.LOCFLG),n.writeUInt16LE(a,Constants.LOCHOW),n.writeUInt32LE(t,Constants.LOCTIM),n.writeUInt32LE(i,Constants.LOCCRC),n.writeUInt32LE(s,Constants.LOCSIZ),n.writeUInt32LE(l,Constants.LOCLEN),n.writeUInt16LE(o,Constants.LOCNAM),n.writeUInt16LE(u,Constants.LOCEXT),n},entryHeaderToBinary:function(){var m=new Buffer(Constants.CENHDR+o+u+h);return m.writeUInt32LE(Constants.CENSIG,0),m.writeUInt16LE(n,Constants.CENVEM),m.writeUInt16LE(e,Constants.CENVER),m.writeUInt16LE(r,Constants.CENFLG),m.writeUInt16LE(a,Constants.CENHOW),m.writeUInt32LE(t,Constants.CENTIM),m.writeInt32LE(i,Constants.CENCRC,!0),m.writeUInt32LE(s,Constants.CENSIZ),m.writeUInt32LE(l,Constants.CENLEN),m.writeUInt16LE(o,Constants.CENNAM),m.writeUInt16LE(u,Constants.CENEXT),m.writeUInt16LE(h,Constants.CENCOM),m.writeUInt16LE(c,Constants.CENDSK),m.writeUInt16LE(d,Constants.CENATT),m.writeUInt32LE(f,Constants.CENATX),m.writeUInt32LE(g,Constants.CENOFF),m.fill(0,Constants.CENHDR),m},toString:function(){return'{\n	"made" : '+n+',\n	"version" : '+e+',\n	"flags" : '+r+',\n	"method" : '+Utils.methodToString(a)+',\n	"time" : '+t+',\n	"crc" : 0x'+i.toString(16).toUpperCase()+',\n	"compressedSize" : '+s+' bytes,\n	"size" : '+l+' bytes,\n	"fileNameLength" : '+o+',\n	"extraLength" : '+u+' bytes,\n	"commentLength" : '+h+' bytes,\n	"diskNumStart" : '+c+',\n	"inAttr" : '+d+',\n	"attr" : '+f+',\n	"offset" : '+g+',\n	"entryHeaderSize" : '+(Constants.CENHDR+o+u+h)+" bytes\n}"}}};