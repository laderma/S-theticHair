function iterateFilter(n){var e=this,t={};return utils.isArray(n)?utils.map(n,function(n){return e.apply(null,arguments)}):"object"==typeof n?(utils.each(n,function(n,r){t[r]=e.apply(null,arguments)}),t):void 0}var utils=require("./utils"),dateFormatter=require("./dateformatter");exports.addslashes=function(n){var e=iterateFilter.apply(exports.addslashes,arguments);return void 0!==e?e:n.replace(/\\/g,"\\\\").replace(/\'/g,"\\'").replace(/\"/g,'\\"')},exports.capitalize=function(n){var e=iterateFilter.apply(exports.capitalize,arguments);return void 0!==e?e:n.toString().charAt(0).toUpperCase()+n.toString().substr(1).toLowerCase()},exports.date=function(n,e,t,r){var s,a=e.length,i=new dateFormatter.DateZ(n),o=0,l="";for(t&&i.setTimezoneOffset(t,r),o;a>o;o+=1)s=e.charAt(o),"\\"===s?(o+=1,l+=a>o?e.charAt(o):s):l+=dateFormatter.hasOwnProperty(s)?dateFormatter[s](i,t,r):s;return l},exports["default"]=function(n,e){return"undefined"==typeof n||!n&&"number"!=typeof n?e:n},exports.escape=function(n,e){var i,t=iterateFilter.apply(exports.escape,arguments),r=n,a=0;if(void 0!==t)return t;if("string"!=typeof n)return n;switch(t="",e){case"js":for(r=r.replace(/\\/g,"\\u005C"),a;a<r.length;a+=1)i=r.charCodeAt(a),32>i?(i=i.toString(16).toUpperCase(),i=i.length<2?"0"+i:i,t+="\\u00"+i):t+=r[a];return t.replace(/&/g,"\\u0026").replace(/</g,"\\u003C").replace(/>/g,"\\u003E").replace(/\'/g,"\\u0027").replace(/"/g,"\\u0022").replace(/\=/g,"\\u003D").replace(/-/g,"\\u002D").replace(/;/g,"\\u003B");default:return r.replace(/&(?!amp;|lt;|gt;|quot;|#39;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}},exports.e=exports.escape,exports.first=function(n){if("object"==typeof n&&!utils.isArray(n)){var e=utils.keys(n);return n[e[0]]}return"string"==typeof n?n.substr(0,1):n[0]},exports.groupBy=function(n,e){if(!utils.isArray(n))return n;var t={};return utils.each(n,function(n){if(n.hasOwnProperty(e)){var r=n[e];utils.extend({},n);delete n[e],t[r]||(t[r]=[]),t[r].push(n)}}),t},exports.join=function(n,e){if(utils.isArray(n))return n.join(e);if("object"==typeof n){var t=[];return utils.each(n,function(n){t.push(n)}),t.join(e)}return n},exports.json=function(n,e){return JSON.stringify(n,null,e||0)},exports.json_encode=exports.json,exports.last=function(n){if("object"==typeof n&&!utils.isArray(n)){var e=utils.keys(n);return n[e[e.length-1]]}return"string"==typeof n?n.charAt(n.length-1):n[n.length-1]},exports.lower=function(n){var e=iterateFilter.apply(exports.lower,arguments);return void 0!==e?e:n.toString().toLowerCase()},exports.raw=function(n){return exports.safe(n)},exports.raw.safe=!0,exports.replace=function(n,e,t,r){var a=new RegExp(e,r);return n.replace(a,t)},exports.reverse=function(n){return exports.sort(n,!0)},exports.safe=function(n){return n},exports.safe.safe=!0,exports.sort=function(n,e){var t;if(utils.isArray(n))t=n.sort();else switch(typeof n){case"object":t=utils.keys(n).sort();break;case"string":return t=n.split(""),e?t.reverse().join(""):t.sort().join("")}return t&&e?t.reverse():t||n},exports.striptags=function(n){var e=iterateFilter.apply(exports.striptags,arguments);return void 0!==e?e:n.toString().replace(/(<([^>]+)>)/gi,"")},exports.title=function(n){var e=iterateFilter.apply(exports.title,arguments);return void 0!==e?e:n.toString().replace(/\w\S*/g,function(n){return n.charAt(0).toUpperCase()+n.substr(1).toLowerCase()})},exports.uniq=function(n){var e;return n&&utils.isArray(n)?(e=[],utils.each(n,function(n){-1===e.indexOf(n)&&e.push(n)}),e):""},exports.upper=function(n){var e=iterateFilter.apply(exports.upper,arguments);return void 0!==e?e:n.toString().toUpperCase()},exports.url_encode=function(n){var e=iterateFilter.apply(exports.url_encode,arguments);return void 0!==e?e:encodeURIComponent(n)},exports.url_decode=function(n){var e=iterateFilter.apply(exports.url_decode,arguments);return void 0!==e?e:decodeURIComponent(n)};