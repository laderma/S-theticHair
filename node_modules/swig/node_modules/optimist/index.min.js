function Argv(e,n){function s(e){t.showHelp(),e&&console.error(e),process.exit(1)}function c(e){var n=minimist(e,r);n.$0=t.$0,a._&&n._.length<a._&&s("Not enough non-option arguments: got "+n._.length+", need at least "+a._);var i=[];return Object.keys(a).forEach(function(e){n[e]||i.push(e)}),i.length&&s("Missing required arguments: "+i.join(", ")),o.forEach(function(e){try{e(n)===!1&&s("Argument check failed: "+e.toString())}catch(t){s(t)}}),n}function d(e){return Math.max.apply(null,e.map(function(e){return e.length}))}var t={};n||(n=process.cwd()),t.$0=process.argv.slice(0,2).map(function(e){var t=rebase(n,e);return e.match(/^\//)&&t.length<e.length?t:e}).join(" "),void 0!=process.env._&&process.argv[1]==process.env._&&(t.$0=process.env._.replace(path.dirname(process.execPath)+"/",""));var r={"boolean":[],string:[],alias:{},"default":[]};t["boolean"]=function(e){return r["boolean"].push.apply(r["boolean"],[].concat(e)),t},t.string=function(e){return r.string.push.apply(r.string,[].concat(e)),t},t["default"]=function(e,n){return"object"==typeof e?Object.keys(e).forEach(function(n){t["default"](n,e[n])}):r["default"][e]=n,t},t.alias=function(e,n){return"object"==typeof e?Object.keys(e).forEach(function(n){t.alias(n,e[n])}):r.alias[e]=(r.alias[e]||[]).concat(n),t};var a={};t.demand=function(e){return"number"==typeof e?(a._||(a._=0),a._+=e):Array.isArray(e)?e.forEach(function(e){t.demand(e)}):a[e]=!0,t};var i;t.usage=function(e,n){return n||"object"!=typeof e||(n=e,e=null),i=e,n&&t.options(n),t};var o=[];t.check=function(e){return o.push(e),t};var l={};t.describe=function(e,n){return"object"==typeof e?Object.keys(e).forEach(function(n){t.describe(n,e[n])}):l[e]=n,t},t.parse=function(e){return c(e)},t.option=t.options=function(e,n){if("object"==typeof e)Object.keys(e).forEach(function(n){t.options(n,e[n])});else{n.alias&&t.alias(e,n.alias),n.demand&&t.demand(e),"undefined"!=typeof n["default"]&&t["default"](e,n["default"]),(n["boolean"]||"boolean"===n.type)&&t["boolean"](e),(n.string||"string"===n.type)&&t.string(e);var r=n.describe||n.description||n.desc;r&&t.describe(e,r)}return t};var u=null;return t.wrap=function(e){return u=e,t},t.showHelp=function(e){e||(e=console.error),e(t.help())},t.help=function(){var e=Object.keys(Object.keys(l).concat(Object.keys(a)).concat(Object.keys(r["default"])).reduce(function(e,n){return"_"!==n&&(e[n]=!0),e},{})),n=e.length?["Options:"]:[];i&&n.unshift(i.replace(/\$0/g,t.$0),"");var s=e.reduce(function(e,n){return e[n]=[n].concat(r.alias[n]||[]).map(function(e){return(e.length>1?"--":"-")+e}).join(", "),e},{}),o=d(Object.keys(s).map(function(e){return s[e]||""})),c=d(Object.keys(l).map(function(e){return l[e]||""}));return e.forEach(function(e){var t=s[e],i=l[e]||"";u&&(i=wordwrap(o+4,u)(i).slice(o+4));var d=new Array(Math.max(o-t.length+3,0)).join(" "),f=new Array(Math.max(c-i.length+1,0)).join(" "),h=null;r["boolean"][e]&&(h="[boolean]"),r.string[e]&&(h="[string]"),!u&&f.length>0&&(i+=f);var p="  "+t+d,m=[h,a[e]?"[required]":null,void 0!==r["default"][e]?"[default: "+JSON.stringify(r["default"][e])+"]":null].filter(Boolean).join("  "),g=[i,m].filter(Boolean).join("  ");if(u){var b=i.split("\n"),_=b.slice(-1)[0].length+(1===b.length?p.length:0);g=i+(_+m.length>u-2?"\n"+new Array(u-m.length+1).join(" ")+m:new Array(u-m.length-_+1).join(" ")+m)}n.push(p+g)}),n.push(""),n.join("\n")},Object.defineProperty(t,"argv",{get:function(){return c(e)},enumerable:!0}),t}function rebase(e,n){for(var t=path.normalize(n).split("/").slice(1),r=path.normalize(e).split("/").slice(1),a=0;t[a]&&t[a]==r[a];a++);t.splice(0,a),r.splice(0,a);var i=path.normalize(r.map(function(){return".."}).concat(t).join("/")).replace(/\/$/,"").replace(/^$/,".");return i.match(/^[.\/]/)?i:"./"+i}var path=require("path"),minimist=require("minimist"),wordwrap=require("wordwrap"),inst=Argv(process.argv.slice(2));Object.keys(inst).forEach(function(e){Argv[e]="function"==typeof inst[e]?inst[e].bind(inst):inst[e]});var exports=module.exports=Argv;exports.rebase=rebase;