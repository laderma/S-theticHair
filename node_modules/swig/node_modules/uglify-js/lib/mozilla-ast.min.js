"use strict";!function(){function n(e){var n=e.loc,t=n&&n.start,r=e.range;return new AST_Token({file:n&&n.source,line:t&&t.line,col:t&&t.column,pos:r?r[0]:e.start,endline:t&&t.line,endcol:t&&t.column,endpos:r?r[0]:e.start})}function t(e){var n=e.loc,t=n&&n.end,r=e.range;return new AST_Token({file:n&&n.source,line:t&&t.line,col:t&&t.column,pos:r?r[1]:e.end,endline:t&&t.line,endcol:t&&t.column,endpos:r?r[1]:e.end})}function r(r,a,o){var c="function From_Moz_"+r+"(M){\n";c+="return new "+a.name+"({\nstart: my_start_token(M),\nend: my_end_token(M)";var f="function To_Moz_"+r+"(M){\n";f+="return {\ntype: "+JSON.stringify(r),o&&o.split(/\s*,\s*/).forEach(function(e){var n=/([a-z0-9$_]+)(=|@|>|%)([a-z0-9$_]+)/i.exec(e);if(!n)throw new Error("Can't understand property map: "+e);var t=n[1],r=n[2],a=n[3];switch(c+=",\n"+a+": ",f+=",\n"+t+": ",r){case"@":c+="M."+t+".map(from_moz)",f+="M."+a+".map(to_moz)";break;case">":c+="from_moz(M."+t+")",f+="to_moz(M."+a+")";break;case"=":c+="M."+t,f+="M."+a;break;case"%":c+="from_moz(M."+t+").body",f+="to_moz_block(M)";break;default:throw new Error("Can't understand operator in propmap: "+e)}}),c+="\n})\n}",f+="\n}\n}",c=new Function("my_start_token","my_end_token","from_moz","return("+c+")")(n,t,i),f=new Function("to_moz","to_moz_block","return("+f+")")(u,l),e[r]=c,s(a,f)}function i(n){a.push(n);var t=null!=n?e[n.type](n):null;return a.pop(),t}function o(e,n,t){var r=e.start,a=e.end;return null!=r.pos&&null!=a.endpos&&(n.range=[r.pos,a.endpos]),r.line&&(n.loc={start:{line:r.line,column:r.col},end:a.endline?{line:a.endline,column:a.endcol}:null},r.file&&(n.loc.source=r.file)),n}function s(e,n){e.DEFMETHOD("to_mozilla_ast",function(){return o(this,n(this))})}function u(e){return null!=e?e.to_mozilla_ast():null}function l(e){return{type:"BlockStatement",body:e.body.map(u)}}var e={ExpressionStatement:function(e){var r=e.expression;return"Literal"===r.type&&"string"==typeof r.value?new AST_Directive({start:n(e),end:t(e),value:r.value}):new AST_SimpleStatement({start:n(e),end:t(e),body:i(r)})},TryStatement:function(e){var r=e.handlers||[e.handler];if(r.length>1||e.guardedHandlers&&e.guardedHandlers.length)throw new Error("Multiple catch clauses are not supported.");return new AST_Try({start:n(e),end:t(e),body:i(e.block).body,bcatch:i(r[0]),bfinally:e.finalizer?new AST_Finally(i(e.finalizer)):null})},Property:function(e){var r=e.key,a="Identifier"==r.type?r.name:r.value,o={start:n(r),end:t(e.value),key:a,value:i(e.value)};switch(e.kind){case"init":return new AST_ObjectKeyVal(o);case"set":return o.value.name=i(r),new AST_ObjectSetter(o);case"get":return o.value.name=i(r),new AST_ObjectGetter(o)}},ObjectExpression:function(e){return new AST_Object({start:n(e),end:t(e),properties:e.properties.map(function(e){return e.type="Property",i(e)})})},SequenceExpression:function(e){return AST_Seq.from_array(e.expressions.map(i))},MemberExpression:function(e){return new(e.computed?AST_Sub:AST_Dot)({start:n(e),end:t(e),property:e.computed?i(e.property):e.property.name,expression:i(e.object)})},SwitchCase:function(e){return new(e.test?AST_Case:AST_Default)({start:n(e),end:t(e),expression:i(e.test),body:e.consequent.map(i)})},VariableDeclaration:function(e){return new("const"===e.kind?AST_Const:AST_Var)({start:n(e),end:t(e),definitions:e.declarations.map(i)})},Literal:function(e){var r=e.value,a={start:n(e),end:t(e)};if(null===r)return new AST_Null(a);switch(typeof r){case"string":return a.value=r,new AST_String(a);case"number":return a.value=r,new AST_Number(a);case"boolean":return new(r?AST_True:AST_False)(a);default:return a.value=r,new AST_RegExp(a)}},Identifier:function(e){var r=a[a.length-2];return new("LabeledStatement"==r.type?AST_Label:"VariableDeclarator"==r.type&&r.id===e?"const"==r.kind?AST_SymbolConst:AST_SymbolVar:"FunctionExpression"==r.type?r.id===e?AST_SymbolLambda:AST_SymbolFunarg:"FunctionDeclaration"==r.type?r.id===e?AST_SymbolDefun:AST_SymbolFunarg:"CatchClause"==r.type?AST_SymbolCatch:"BreakStatement"==r.type||"ContinueStatement"==r.type?AST_LabelRef:AST_SymbolRef)({start:n(e),end:t(e),name:e.name})}};e.UpdateExpression=e.UnaryExpression=function(e){var r="prefix"in e?e.prefix:"UnaryExpression"==e.type?!0:!1;return new(r?AST_UnaryPrefix:AST_UnaryPostfix)({start:n(e),end:t(e),operator:e.operator,expression:i(e.argument)})},r("Program",AST_Toplevel,"body@body"),r("EmptyStatement",AST_EmptyStatement),r("BlockStatement",AST_BlockStatement,"body@body"),r("IfStatement",AST_If,"test>condition, consequent>body, alternate>alternative"),r("LabeledStatement",AST_LabeledStatement,"label>label, body>body"),r("BreakStatement",AST_Break,"label>label"),r("ContinueStatement",AST_Continue,"label>label"),r("WithStatement",AST_With,"object>expression, body>body"),r("SwitchStatement",AST_Switch,"discriminant>expression, cases@body"),r("ReturnStatement",AST_Return,"argument>value"),r("ThrowStatement",AST_Throw,"argument>value"),r("WhileStatement",AST_While,"test>condition, body>body"),r("DoWhileStatement",AST_Do,"test>condition, body>body"),r("ForStatement",AST_For,"init>init, test>condition, update>step, body>body"),r("ForInStatement",AST_ForIn,"left>init, right>object, body>body"),r("DebuggerStatement",AST_Debugger),r("FunctionDeclaration",AST_Defun,"id>name, params@argnames, body%body"),r("VariableDeclarator",AST_VarDef,"id>name, init>value"),r("CatchClause",AST_Catch,"param>argname, body%body"),r("ThisExpression",AST_This),r("ArrayExpression",AST_Array,"elements@elements"),r("FunctionExpression",AST_Function,"id>name, params@argnames, body%body"),r("BinaryExpression",AST_Binary,"operator=operator, left>left, right>right"),r("LogicalExpression",AST_Binary,"operator=operator, left>left, right>right"),r("AssignmentExpression",AST_Assign,"operator=operator, left>left, right>right"),r("ConditionalExpression",AST_Conditional,"test>condition, consequent>consequent, alternate>alternative"),r("NewExpression",AST_New,"callee>expression, arguments@args"),r("CallExpression",AST_Call,"callee>expression, arguments@args"),s(AST_Directive,function(e){return{type:"ExpressionStatement",expression:{type:"Literal",value:e.value}}}),s(AST_SimpleStatement,function(e){return{type:"ExpressionStatement",expression:u(e.body)}}),s(AST_SwitchBranch,function(e){return{type:"SwitchCase",test:u(e.expression),consequent:e.body.map(u)}}),s(AST_Try,function(e){return{type:"TryStatement",block:l(e),handler:u(e.bcatch),guardedHandlers:[],finalizer:u(e.bfinally)}}),s(AST_Catch,function(e){return{type:"CatchClause",param:u(e.argname),guard:null,body:l(e)}}),s(AST_Definitions,function(e){return{type:"VariableDeclaration",kind:e instanceof AST_Const?"const":"var",declarations:e.definitions.map(u)}}),s(AST_Seq,function(e){return{type:"SequenceExpression",expressions:e.to_array().map(u)}}),s(AST_PropAccess,function(e){var n=e instanceof AST_Sub;return{type:"MemberExpression",object:u(e.expression),computed:n,property:n?u(e.property):{type:"Identifier",name:e.property}}}),s(AST_Unary,function(e){return{type:"++"==e.operator||"--"==e.operator?"UpdateExpression":"UnaryExpression",operator:e.operator,prefix:e instanceof AST_UnaryPrefix,argument:u(e.expression)}}),s(AST_Binary,function(e){return{type:"&&"==e.operator||"||"==e.operator?"LogicalExpression":"BinaryExpression",left:u(e.left),operator:e.operator,right:u(e.right)}}),s(AST_Object,function(e){return{type:"ObjectExpression",properties:e.properties.map(u)}}),s(AST_ObjectProperty,function(e){var t,n=is_identifier(e.key)?{type:"Identifier",name:e.key}:{type:"Literal",value:e.key};return e instanceof AST_ObjectKeyVal?t="init":e instanceof AST_ObjectGetter?t="get":e instanceof AST_ObjectSetter&&(t="set"),{type:"Property",kind:t,key:n,value:u(e.value)}}),s(AST_Symbol,function(e){var n=e.definition();return{type:"Identifier",name:n?n.mangled_name||n.name:e.name}}),s(AST_Constant,function(e){var n=e.value;return"number"==typeof n&&(0>n||0===n&&0>1/n)?{type:"UnaryExpression",operator:"-",prefix:!0,argument:{type:"Literal",value:-n}}:{type:"Literal",value:n}}),s(AST_Atom,function(e){return{type:"Identifier",name:String(e.value)}}),AST_Boolean.DEFMETHOD("to_mozilla_ast",AST_Constant.prototype.to_mozilla_ast),AST_Null.DEFMETHOD("to_mozilla_ast",AST_Constant.prototype.to_mozilla_ast),AST_Hole.DEFMETHOD("to_mozilla_ast",function(){return null}),AST_Block.DEFMETHOD("to_mozilla_ast",AST_BlockStatement.prototype.to_mozilla_ast),AST_Lambda.DEFMETHOD("to_mozilla_ast",AST_Function.prototype.to_mozilla_ast);var a=null;AST_Node.from_mozilla_ast=function(e){var n=a;a=[];var t=i(e);return a=n,t}}();