function alphasort(n,e){return n=n.toLowerCase(),e=e.toLowerCase(),n>e?1:e>n?-1:0}function cleanResults(n){return n.map(function(n){return n.replace(/\/+/g,"/").replace(/\/$/,"")}).sort(alphasort).reduce(function(n,e){return e!==n[n.length-1]&&n.push(e),n},[]).sort(alphasort).map(function(n){return"win32"!==process.platform?n:n.replace(/^[a-zA-Z]:\\\\/,"/").replace(/\\/g,"/")})}var tap=require("tap"),child_process=require("child_process"),pattern="test/a/!(symlink)/**",bashResults=require("./bash-results.json"),patterns=Object.keys(bashResults),glob=require("../"),Glob=glob.Glob,path=require("path");process.chdir(path.resolve(__dirname,".."));var globResults=[];tap.test("use a Glob object, and pause/resume it",function(n){var e=new Glob(pattern),a=bashResults[pattern];e.on("pause",function(){console.error("pause")}),e.on("resume",function(){console.error("resume")}),e.on("match",function(t){n.notOk(e.paused,"must not be paused"),globResults.push(t),e.pause(),n.ok(e.paused,"must be paused"),setTimeout(e.resume.bind(e),10)}),e.on("end",function(e){n.pass("reached glob end"),globResults=cleanResults(globResults),e=cleanResults(e),n.deepEqual(e,globResults,"end event matches should be the same as match events"),n.deepEqual(e,a,"glob matches should be the same as bash results"),n.end()})});