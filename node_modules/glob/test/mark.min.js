var test=require("tap").test,glob=require("../");process.chdir(__dirname);var lag=5;glob.Glob.prototype._stat=function(n){return function(e,t){arguments;setTimeout(function(){n.call(this,e,t)}.bind(this),lag+=5)}}(glob.Glob.prototype._stat),test("mark, with **",function(n){glob("a/*b*/**",{mark:!0},function(e,t){if(e)throw e;var r=["a/abcdef/","a/abcdef/g/","a/abcdef/g/h","a/abcfed/","a/abcfed/g/","a/abcfed/g/h","a/b/","a/b/c/","a/b/c/d","a/bc/","a/bc/e/","a/bc/e/f","a/cb/","a/cb/e/","a/cb/e/f"];n.same(t,r),n.end()})}),test("mark, no / on pattern",function(n){glob("a/*",{mark:!0},function(e,t){if(e)throw e;var r=["a/abcdef/","a/abcfed/","a/b/","a/bc/","a/c/","a/cb/"];"win32"!==process.platform&&r.push("a/symlink/"),n.same(t,r),n.end()}).on("match",function(e){n.similar(e,/\/$/)})}),test("mark=false, no / on pattern",function(n){glob("a/*",function(e,t){if(e)throw e;var r=["a/abcdef","a/abcfed","a/b","a/bc","a/c","a/cb"];"win32"!==process.platform&&r.push("a/symlink"),n.same(t,r),n.end()}).on("match",function(e){n.similar(e,/[^\/]$/)})}),test("mark=true, / on pattern",function(n){glob("a/*/",{mark:!0},function(e,t){if(e)throw e;var r=["a/abcdef/","a/abcfed/","a/b/","a/bc/","a/c/","a/cb/"];"win32"!==process.platform&&r.push("a/symlink/"),n.same(t,r),n.end()}).on("match",function(e){n.similar(e,/\/$/)})}),test("mark=false, / on pattern",function(n){glob("a/*/",function(e,t){if(e)throw e;var r=["a/abcdef/","a/abcfed/","a/b/","a/bc/","a/c/","a/cb/"];"win32"!==process.platform&&r.push("a/symlink/"),n.same(t,r),n.end()}).on("match",function(e){n.similar(e,/\/$/)})});