var parse=require("./parse"),_=require("lodash"),api=[require("./api/attributes"),require("./api/traversing"),require("./api/manipulation"),require("./api/css")],quickExpr=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,Cheerio=module.exports=function(n,e,r,a){return this instanceof Cheerio?(this.options=_.defaults(a||{},this.options),n?(r&&("string"==typeof r&&(r=parse(r,this.options)),this._root=Cheerio.call(this,r)),n.cheerio?n:(isNode(n)&&(n=[n]),Array.isArray(n)?(_.forEach(n,function(n,e){this[e]=n},this),this.length=n.length,this):"string"==typeof n&&isHtml(n)?Cheerio.call(this,parse(n,this.options).children):(e?"string"==typeof e?isHtml(e)?(e=parse(e,this.options),e=Cheerio.call(this,e)):(n=[e,n].join(" "),e=this._root):e.cheerio||(e=Cheerio.call(this,e)):e=this._root,e?e.find(n):this))):this):new Cheerio(n,e,r,a)};_.extend(Cheerio,require("./static")),Cheerio.prototype.cheerio="[cheerio object]",Cheerio.prototype.options={withDomLvl1:!0,normalizeWhitespace:!1,xmlMode:!1,decodeEntities:!0},Cheerio.prototype.length=0,Cheerio.prototype.splice=Array.prototype.splice;var isHtml=function(n){if("<"===n.charAt(0)&&">"===n.charAt(n.length-1)&&n.length>=3)return!0;var e=quickExpr.exec(n);return!(!e||!e[1])};Cheerio.prototype._make=function(n,e){var r=new Cheerio(n,e,this._root,this.options);return r.prevObject=this,r},Cheerio.prototype.toArray=function(){return this.get()},api.forEach(function(n){_.extend(Cheerio.prototype,n)});var isNode=function(n){return n.name||"text"===n.type||"comment"===n.type};