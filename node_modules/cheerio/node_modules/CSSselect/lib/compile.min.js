function compile(e,n){var t=compileUnsafe(e,n);return function(e){return isTag(e)&&t(e)}}function compileUnsafe(e,n){return parse(e,n).map(compileRules).reduce(reduceRules,falseFunc)}function compileRules(e){return 0===e.length?falseFunc:sortRules(e).reduce(function(e,n){return e===falseFunc?e:Rules[n.type](e,n)},trueFunc)}function reduceRules(e,n){return n===falseFunc||e===trueFunc?e:e===falseFunc||n===trueFunc?n:function(t){return e(t)||n(t)}}module.exports=compile,module.exports.compileUnsafe=compileUnsafe;var parse=require("CSSwhat"),DomUtils=require("domutils"),isTag=DomUtils.isTag,Rules=require("./general.js"),sortRules=require("./sort.js"),BaseFuncs=require("./basefunctions.js"),trueFunc=BaseFuncs.trueFunc,falseFunc=BaseFuncs.falseFunc,Pseudos=require("./pseudos.js"),filters=Pseudos.filters,isParent=Pseudos.pseudos.parent,existsOne=DomUtils.existsOne,getChildren=DomUtils.getChildren;filters.not=function(e,n){var t=compileUnsafe(n);return t===falseFunc?e:t===trueFunc?falseFunc:function(n){return!t(n)&&e(n)}},filters.has=function(e,n){var t=compile(n);return t===falseFunc?falseFunc:t===trueFunc?function(n){return isParent(n)&&e(n)}:function(n){return e(n)&&existsOne(t,getChildren(n))}};