var assert=require("assert"),path=require("path"),entities=require("../");describe("Encode->decode test",function(){var e=[{input:"asdf & ÿ ü '",xml:"asdf &amp; &#xFF; &#xFC; &apos;",html:"asdf &amp; &yuml; &uuml; &apos;"},{input:"&#38;",xml:"&amp;#38;",html:"&amp;&num;38&semi;"}];e.forEach(function(e){var n=entities.encodeXML(e.input);it("should XML encode "+e.input,function(){assert.equal(n,e.xml)}),it("should default to XML encode "+e.input,function(){assert.equal(entities.encode(e.input),e.xml)}),it("should XML decode "+n,function(){assert.equal(entities.decodeXML(n),e.input)}),it("should default to XML encode "+n,function(){assert.equal(entities.decode(n),e.input)}),it("should default strict to XML encode "+n,function(){assert.equal(entities.decodeStrict(n),e.input)});var t=entities.encodeHTML5(e.input);it("should HTML5 encode "+e.input,function(){assert.equal(t,e.html)}),it("should HTML5 decode "+t,function(){assert.equal(entities.decodeHTML(t),e.input)})}),it("should encode data URIs (issue 16)",function(){var e="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAALAAABAAEAAAIBRAA7";assert.equal(entities.decode(entities.encode(e)),e)})}),describe("Decode test",function(){var e=[{input:"&amp;amp;",output:"&amp;"},{input:"&amp;#38;",output:"&#38;"},{input:"&amp;#x26;",output:"&#x26;"},{input:"&amp;#X26;",output:"&#X26;"},{input:"&#38;#38;",output:"&#38;"},{input:"&#x26;#38;",output:"&#38;"},{input:"&#X26;#38;",output:"&#38;"},{input:"&#x3a;",output:":"},{input:"&#x3A;",output:":"},{input:"&#X3a;",output:":"},{input:"&#X3A;",output:":"}];e.forEach(function(e){it("should XML decode "+e.input,function(){assert.equal(entities.decodeXML(e.input),e.output)}),it("should HTML4 decode "+e.input,function(){assert.equal(entities.decodeHTML(e.input),e.output)}),it("should HTML5 decode "+e.input,function(){assert.equal(entities.decodeHTML(e.input),e.output)})})});var levels=["xml","entities"];describe("Documents",function(){function n(){Object.keys(e).forEach(function(n){assert.equal(entities.decodeHTML("&"+n),e[n])})}levels.map(function(e){return path.join("..","maps",e)}).map(require).forEach(function(e,n){describe("Decode",function(){it(levels[n],function(){Object.keys(e).forEach(function(t){for(var r=n;r<levels.length;r++)assert.equal(entities.decode("&"+t+";",r),e[t])})})}),describe("Decode strict",function(){it(levels[n],function(){Object.keys(e).forEach(function(t){for(var r=n;r<levels.length;r++)assert.equal(entities.decodeStrict("&"+t+";",r),e[t])})})}),describe("Encode",function(){it(levels[n],function(){Object.keys(e).forEach(function(t){for(var r=n;r<levels.length;r++)assert.equal(entities.decode(entities.encode(e[t],r),r),e[t])})})})});var e=require("../maps/legacy.json");describe("Legacy",function(){it("should decode",n)})});var astral={"1D306":"𝌆","1D11E":"𝄞"},astralSpecial={80:"€",110000:"�"};describe("Astral entities",function(){Object.keys(astral).forEach(function(e){it("should decode "+astral[e],function(){assert.equal(entities.decode("&#x"+e+";"),astral[e])}),it("should encode "+astral[e],function(){assert.equal(entities.encode(astral[e]),"&#x"+e+";")}),it("should escape "+astral[e],function(){assert.equal(entities.escape(astral[e]),"&#x"+e+";")})}),Object.keys(astralSpecial).forEach(function(e){it("special should decode \\u"+e,function(){assert.equal(entities.decode("&#x"+e+";"),astralSpecial[e])})})}),describe("Escape",function(){it("should always decode ASCII chars",function(){for(var e=0;127>e;e++){var n=String.fromCharCode(e);assert.equal(entities.decodeXML(entities.escape(n)),n)}})});