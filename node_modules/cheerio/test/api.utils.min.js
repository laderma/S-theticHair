var expect=require("expect.js"),fixtures=require("./fixtures"),cheerio=require("..");describe("cheerio",function(){describe(".html",function(){it("() : should return innerHTML; $.html(obj) should return outerHTML",function(){var n=cheerio("div","<div><span>foo</span><span>bar</span></div>"),e=n.children()[1];expect(cheerio(e).html()).to.equal("bar"),expect(cheerio.html(e)).to.equal("<span>bar</span>")}),it("(<obj>) : should accept an object, an array, or a cheerio object",function(){var n=cheerio("<span>foo</span>");expect(cheerio.html(n[0])).to.equal("<span>foo</span>"),expect(cheerio.html(n)).to.equal("<span>foo</span>")}),it("(<value>) : should be able to set to an empty string",function(){var n=cheerio("<span>foo</span>").html("");expect(cheerio.html(n)).to.equal("<span></span>")}),it("() : of empty cheerio object should return null",function(){expect(cheerio().html()).to.be(null)}),it("(selector) : should return the outerHTML of the selected element",function(){var n=cheerio.load(fixtures.fruits);expect(n.html(".pear")).to.equal('<li class="pear">Pear</li>')})}),describe(".load",function(){it("(html) : should retain original root after creating a new node",function(){var n=cheerio.load('<body><ul id="fruits"></ul></body>');expect(n("body")).to.have.length(1),n("<script>"),expect(n("body")).to.have.length(1)}),it("(html) : should handle lowercase tag options",function(){var n=cheerio.load('<BODY><ul id="fruits"></ul></BODY>',{lowerCaseTags:!0});expect(n.html()).to.be('<body><ul id="fruits"></ul></body>')}),it("(html) : should handle the `normalizeWhitepace` option",function(){var n=cheerio.load("<body><b>foo</b>  <b>bar</b></body>",{normalizeWhitespace:!0});expect(n.html()).to.be("<body><b>foo</b> <b>bar</b></body>")}),it("(buffer) : should accept a buffer",function(){var n=cheerio.load(new Buffer("<div>foo</div>"));expect(n.html()).to.be("<div>foo</div>")})}),describe(".clone",function(){it("() : should return a copy",function(){var n=cheerio("<div><span>foo</span><span>bar</span><span>baz</span></div>").children(),e=n.clone();expect(e.length).to.equal(3),expect(e.parent()).to.have.length(0),expect(e.text()).to.equal(n.text()),n.text("rofl"),expect(e.text()).to.not.equal(n.text())}),it("() : should preserve parsing options",function(){var n=cheerio.load("<div>Ï€</div>",{decodeEntities:!1}),e=n("div");expect(e.text()).to.equal(e.clone().text())})}),describe(".parseHTML",function(){it("() : returns null",function(){expect(cheerio.parseHTML()).to.equal(null)}),it("(null) : returns null",function(){expect(cheerio.parseHTML(null)).to.equal(null)}),it('("") : returns null',function(){expect(cheerio.parseHTML("")).to.equal(null)}),it("(largeHtmlString) : parses large HTML strings",function(){var n=new Array(10).join("<div></div>"),e=cheerio.parseHTML(n);expect(e.length).to.be.greaterThan(4),expect(e).to.be.an("array")}),it('("<script>") : ignores scripts by default',function(){var n="<script>undefined()</script>";expect(cheerio.parseHTML(n)).to.have.length(0)}),it('("<script>", true) : preserves scripts when requested',function(){var n="<script>undefined()</script>";expect(cheerio.parseHTML(n,!0)[0].tagName).to.match(/script/i)}),it('("scriptAndNonScript) : preserves non-script nodes',function(){var n="<script>undefined()</script><div></div>";expect(cheerio.parseHTML(n)[0].tagName).to.match(/div/i)}),it("(scriptAndNonScript, true) : Preserves script position",function(){var n="<script>undefined()</script><div></div>";expect(cheerio.parseHTML(n,!0)[0].tagName).to.match(/script/i)}),it("(text) : returns a text node",function(){expect(cheerio.parseHTML("text")[0].type).to.be("text")}),it("(\\ttext) : preserves leading whitespace",function(){expect(cheerio.parseHTML("	<div></div>")[0].data).to.equal("	")}),it("( text) : Leading spaces are treated as text nodes",function(){expect(cheerio.parseHTML(" <div/> ")[0].type).to.be("text")}),it("(html) : should preserve content",function(){var n="<div>test div</div>";expect(cheerio(cheerio.parseHTML(n)[0]).html()).to.equal("test div")}),it("(malformedHtml) : should not break",function(){expect(cheerio.parseHTML("<span><span>")).to.have.length(1)}),it("(garbageInput) : should not cause an error",function(){expect(cheerio.parseHTML("<#if><tr><p>This is a test.</p></tr><#/if>")||!0).to.be.ok()})}),describe(".contains",function(){var n;beforeEach(function(){n=cheerio.load(fixtures.food)}),it("(container, contained) : should correctly detect the provided element",function(){var e=n("#food"),t=n("#fruits"),r=n(".apple");expect(n.contains(e[0],t[0])).to.equal(!0),expect(n.contains(e[0],r[0])).to.equal(!0)}),it("(container, other) : should not detect elements that are not contained",function(){var e=n("#fruits"),t=n("#vegetables"),r=n(".apple");expect(n.contains(t[0],r[0])).to.equal(!1),expect(n.contains(e[0],t[0])).to.equal(!1),expect(n.contains(t[0],e[0])).to.equal(!1),expect(n.contains(e[0],e[0])).to.equal(!1),expect(n.contains(t[0],t[0])).to.equal(!1)})}),describe(".root",function(){it("() : should return a cheerio-wrapped root object",function(){var n=cheerio.load("<div><span>foo</span><span>bar</span></div>");n.root().append('<div id="test"></div>'),expect(n.html()).to.equal('<div><span>foo</span><span>bar</span></div><div id="test"></div>')})})});