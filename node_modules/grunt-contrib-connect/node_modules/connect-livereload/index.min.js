module.exports=function(e){function d(e,n){return n+e}function f(e,n){return e+n}function h(e){return e?/<[:_-\w\s\!\/\=\"\']+>/i.test(e):!1}function p(e){return e?c.test(e):!1}function m(e){return e?~e.lastIndexOf("/livereload.js"):!1}function g(e){var n=e;return a.some(function(t){return t.match.test(e)?(n=e.replace(t.match,function(e){return t.fn(e,u)}),!0):!1}),n}function _(e){var n=e.headers.accept;return n?~n.indexOf("html"):!1}function b(e,n){return e?n.some(function(n){return n.test&&n.test(e)||~e.indexOf(n)?!0:!1}):!0}var e=e||{},n=e.ignore||e.excludeList||[/\.js(\?.*)?$/,/\.css(\?.*)?$/,/\.svg(\?.*)?$/,/\.ico(\?.*)?$/,/\.woff(\?.*)?$/,/\.png(\?.*)?$/,/\.jpg(\?.*)?$/,/\.jpeg(\?.*)?$/,/\.gif(\?.*)?$/,/\.pdf(\?.*)?$/],t=e.include||[/.*/],r=e.html||h,a=e.rules||[{match:/<\/body>(?![\s\S]*<\/body>)/i,fn:d},{match:/<\/html>(?![\s\S]*<\/html>)/i,fn:d},{match:/<\!DOCTYPE.+?>/i,fn:f}],i=e.disableCompression||!1,s=e.hostname||"localhost",o=e.port||35729,l=e.src||"//' + (location.hostname || '"+s+"') + ':"+o+"/livereload.js?snipver=1",u="\n<script>//<![CDATA[\ndocument.write('<script src=\""+l+"\"><\\/script>')\n//]]></script>\n",c=function(){var e=a.map(function(e){return e.match.source}).join("|");return new RegExp(e,"i")}();return function(e,a,s){if(a._livereload)return s();if(a._livereload=!0,!_(e)||!b(e.url,t)||b(e.url,n))return s();i&&(e.headers["accept-encoding"]="identity");var o=!0,l=a.writeHead,u=a.write,c=a.end;a.push=function(e){a.data=(a.data||"")+e},a.inject=a.write=function(e,n){if(!o)return u.call(a,e,n);if(void 0!==e){var t=e instanceof Buffer?e.toString(n):e;return p(t)&&!m(a.data)?(a.push(g(t)),!0):(a.push(t),!0)}return!0},a.writeHead=function(){if(!o)return l.apply(a,arguments);var e=arguments[arguments.length-1];if("object"==typeof e)for(var n in e)/content-length/i.test(n)&&delete e[n];a.getHeader("content-length")&&a.removeHeader("content-length"),l.apply(a,arguments)},a.end=function(e,n){return o?(a.inject(e),o=!1,r(a.data)&&p(a.data)&&!m(a.data)&&(a.data=g(a.data)),void 0===a.data||a._header||a.setHeader("content-length",Buffer.byteLength(a.data,n)),void c.call(a,a.data,n)):c.call(a,e,n)},s()}};