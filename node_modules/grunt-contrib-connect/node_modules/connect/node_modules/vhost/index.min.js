"use strict";function hostnameof(e){var n=e.headers.host;if(n){var t="["===n[0]?n.indexOf("]")+1:0,r=n.indexOf(":",t);return-1!==r?n.substring(0,r):n}}function isregexp(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function hostregexp(e){var n=isregexp(e)?e.source:String(e).replace(/([.+?^=!:${}()|\[\]\/\\])/g,"\\$1").replace(/\*/g,"([^.]+)");return"^"!==n[0]&&(n="^"+n),n=n.replace(/(\\*)(.)$/,function(e,n,t){return"$"!==t||n.length%2===1?e+"$":e}),new RegExp(n,"i")}function vhostof(e,n){var t=e.headers.host,r=hostnameof(e);if(r){var a=n.exec(r);if(a){var i=Object.create(null);i.host=t,i.hostname=r,i.length=a.length-1;for(var o=1;o<a.length;o++)i[o-1]=a[o];return i}}}module.exports=function(e,n){if(!e)throw new TypeError("argument hostname is required");if(!n)throw new TypeError("argument handle is required");if("function"!=typeof n)throw new TypeError("argument handle must be a function");var t=hostregexp(e);return function(e,r,a){var i=vhostof(e,t);return i?(e.vhost=i,void n(e,r,a)):a()}};