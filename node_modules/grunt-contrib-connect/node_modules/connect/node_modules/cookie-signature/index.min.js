function sha1(e){return crypto.createHash("sha1").update(e).digest("hex")}var crypto=require("crypto");exports.sign=function(e,n){if("string"!=typeof e)throw new TypeError("Cookie value must be provided as a string.");if("string"!=typeof n)throw new TypeError("Secret string must be provided.");return e+"."+crypto.createHmac("sha256",n).update(e).digest("base64").replace(/\=+$/,"")},exports.unsign=function(e,n){if("string"!=typeof e)throw new TypeError("Signed cookie string must be provided.");if("string"!=typeof n)throw new TypeError("Secret string must be provided.");var t=e.slice(0,e.lastIndexOf(".")),r=exports.sign(t,n);return sha1(r)==sha1(e)?t:!1};