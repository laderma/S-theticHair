function unauthorized(e,n){e.statusCode=401,e.setHeader("WWW-Authenticate",'Basic realm="'+n+'"'),e.end("Unauthorized")}function error(e,n){var t=new Error(n||http.STATUS_CODES[e]);return t.status=e,t}var http=require("http");module.exports=function(e,n){var t,r;if("string"==typeof e){if(t=e,r=n,"string"!=typeof r)throw new Error("password argument required");n=arguments[2],e=function(e,n){return e==t&&n==r}}return n=n||"Authorization Required",function(t,r,a){var i=t.headers.authorization;if(t.user)return a();if(!i)return unauthorized(r,n);var o=i.split(" ");if(2!==o.length)return a(error(400));var s=o[0],u=new Buffer(o[1],"base64").toString(),l=u.indexOf(":");if("Basic"!=s||0>l)return a(error(400));var c=u.slice(0,l),f=u.slice(l+1);e.length>=3?e(c,f,function(e,i){return e||!i?unauthorized(r,n):(t.user=t.remoteUser=i,void a())}):e(c,f)?(t.user=t.remoteUser=c,a()):unauthorized(r,n)}};