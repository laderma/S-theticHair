"use strict";function favicon(e,n){var r,a,o,t=n||{},i=calcMaxAge(t.maxAge);if(!e)throw new TypeError("path to favicon.ico is required");if(Buffer.isBuffer(e))r=new Buffer(e.length),e.copy(r),a=createIcon(r,i);else{if("string"!=typeof e)throw new TypeError("path to favicon.ico must be string or buffer");if(e=resolve(e),o=fs.statSync(e),o.isDirectory())throw createIsDirError(e)}return function(n,t,r){return"/favicon.ico"!==parseUrl(n).pathname?void r():"GET"!==n.method&&"HEAD"!==n.method?(t.statusCode="OPTIONS"===n.method?200:405,t.setHeader("Allow","GET, HEAD, OPTIONS"),t.setHeader("Content-Length","0"),void t.end()):a?send(n,t,a):void fs.readFile(e,function(e,o){return e?r(e):(a=createIcon(o,i),void send(n,t,a))})}}function calcMaxAge(e){var n="string"==typeof e?ms(e):e;return null!=n?Math.min(Math.max(0,n),maxMaxAge):maxMaxAge}function createIcon(e,n){return{body:e,headers:{"Cache-Control":"public, max-age="+Math.floor(n/1e3),ETag:etag(e)}}}function createIsDirError(e){var n=new Error("EISDIR, illegal operation on directory '"+e+"'");return n.code="EISDIR",n.errno=28,n.path=e,n.syscall="open",n}function send(e,n,t){for(var r=t.headers,a=Object.keys(r),i=0;i<a.length;i++){var o=a[i];n.setHeader(o,r[o])}return fresh(e.headers,n._headers)?(n.statusCode=304,void n.end()):(n.statusCode=200,n.setHeader("Content-Length",t.body.length),n.setHeader("Content-Type","image/x-icon"),void n.end(t.body))}var etag=require("etag"),fresh=require("fresh"),fs=require("fs"),ms=require("ms"),parseUrl=require("parseurl"),path=require("path"),resolve=path.resolve;module.exports=favicon;var maxMaxAge=31536e6;