function onTimeout(e,n){return function(){n(createError(503,"Response timeout",{code:"ETIMEDOUT",timeout:e}))}}var createError=require("http-errors"),debug=require("debug")("connect:timeout"),ms=require("ms"),onHeaders=require("on-headers");module.exports=function(e,n){n=n||{},e="string"==typeof e?ms(e):Number(e||5e3);var t=!("respond"in n)||n.respond===!0;return function(n,r,i){var a=n.socket.destroy,o=setTimeout(function(){n.timedout=!0,n.emit("timeout",e)},e);t&&n.on("timeout",onTimeout(e,i)),n.clearTimeout=function(){clearTimeout(o)},n.socket.destroy=function(){clearTimeout(o),a.call(this)},n.timedout=!1,onHeaders(r,function(){clearTimeout(o)}),i()}};