"use strict";function EE(e,n,t){this.fn=e,this.context=n,this.once=t||!1}function EventEmitter(){}var prefix="function"!=typeof Object.create?"~":!1;EventEmitter.prototype._events=void 0,EventEmitter.prototype.listeners=function(e,n){var t=prefix?prefix+e:e,r=this._events&&this._events[t];if(n)return!!r;if(!r)return[];if(r.fn)return[r.fn];for(var a=0,i=r.length,o=new Array(i);i>a;a++)o[a]=r[a].fn;return o},EventEmitter.prototype.emit=function(e,n,t,r,a,i){var o=prefix?prefix+e:e;if(!this._events||!this._events[o])return!1;var l,c,s=this._events[o],u=arguments.length;if("function"==typeof s.fn){switch(s.once&&this.removeListener(e,s.fn,void 0,!0),u){case 1:return s.fn.call(s.context),!0;case 2:return s.fn.call(s.context,n),!0;case 3:return s.fn.call(s.context,n,t),!0;case 4:return s.fn.call(s.context,n,t,r),!0;case 5:return s.fn.call(s.context,n,t,r,a),!0;case 6:return s.fn.call(s.context,n,t,r,a,i),!0}for(c=1,l=new Array(u-1);u>c;c++)l[c-1]=arguments[c];s.fn.apply(s.context,l)}else{var d,f=s.length;for(c=0;f>c;c++)switch(s[c].once&&this.removeListener(e,s[c].fn,void 0,!0),u){case 1:s[c].fn.call(s[c].context);break;case 2:s[c].fn.call(s[c].context,n);break;case 3:s[c].fn.call(s[c].context,n,t);break;default:if(!l)for(d=1,l=new Array(u-1);u>d;d++)l[d-1]=arguments[d];s[c].fn.apply(s[c].context,l)}}return!0},EventEmitter.prototype.on=function(e,n,t){var r=new EE(n,t||this),a=prefix?prefix+e:e;return this._events||(this._events=prefix?{}:Object.create(null)),this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],r]:this._events[a].push(r):this._events[a]=r,this},EventEmitter.prototype.once=function(e,n,t){var r=new EE(n,t||this,!0),a=prefix?prefix+e:e;return this._events||(this._events=prefix?{}:Object.create(null)),this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],r]:this._events[a].push(r):this._events[a]=r,this},EventEmitter.prototype.removeListener=function(e,n,t,r){var a=prefix?prefix+e:e;if(!this._events||!this._events[a])return this;var i=this._events[a],o=[];if(n)if(i.fn)(i.fn!==n||r&&!i.once||t&&i.context!==t)&&o.push(i);else for(var s=0,u=i.length;u>s;s++)(i[s].fn!==n||r&&!i[s].once||t&&i[s].context!==t)&&o.push(i[s]);return o.length?this._events[a]=1===o.length?o[0]:o:delete this._events[a],this},EventEmitter.prototype.removeAllListeners=function(e){return this._events?(e?delete this._events[prefix?prefix+e:e]:this._events=prefix?{}:Object.create(null),this):this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prototype.setMaxListeners=function(){return this},EventEmitter.prefixed=prefix,"undefined"!=typeof module&&(module.exports=EventEmitter);