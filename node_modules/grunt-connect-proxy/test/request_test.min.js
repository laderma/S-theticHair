"use strict";var utils=require("../lib/utils.js"),http=require("http");exports.connect_proxy={setUp:function(n){n()},proxied_request:function(n){n.expect(2),http.createServer(function(e,t){n.equal(e.headers["x-proxied-header"],"added","headers should be added to request"),t.writeHead(200,{"Content-Type":"text/plain"}),t.write("request successfully proxied!"),t.end()}).listen(8080),http.request({host:"localhost",path:"/request",port:9e3},function(e){var t="";e.on("data",function(n){t+=n}),e.on("end",function(){n.equal(t,"request successfully proxied!","request should be received"),n.done()})}).end()}};