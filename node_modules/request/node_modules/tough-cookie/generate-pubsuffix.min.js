function processList(e){for(;e.length;){var n=e.shift();n=n.replace(COMMENT,"").trim(),n&&addToIndex(index,n)}pubSufTest();var t=fs.createWriteStream("./lib/pubsuffix.js",{flags:"w",encoding:"utf8",mode:420});t.on("end",process.exit),t.write("/****************************************************\n"),t.write(" * AUTOMATICALLY GENERATED by generate-pubsuffix.js *\n"),t.write(" *                  DO NOT EDIT!                    *\n"),t.write(" ****************************************************/\n\n"),t.write("module.exports.getPublicSuffix = "),t.write(getPublicSuffix.toString()),t.write(";\n\n"),t.write("// The following generated structure is used under the MPL version 1.1\n"),t.write("// See public-suffix.txt for more information\n\n"),t.write("var index = module.exports.index = Object.freeze(\n"),t.write(JSON.stringify(index)),t.write(");\n\n"),t.write("// END of automatically generated file\n"),t.end()}function addToIndex(e,n){var t="";n.replace(/^(!|\*\.)/)&&(t=RegExp.$1,n=n.slice(t.length)),n=t+punycode.toASCII(n),"!"==n.substr(0,1)?e[n.substr(1)]=!1:e[n]=!0}function getPublicSuffix(e){if(!e)return null;if(e.match(/^\./))return null;e=e.toLowerCase();for(var n=e.split(".").reverse(),t="",r=0,a=0;a<n.length;a++){var i=n[a],s="*"+t,o=i+t;index[s]?(r=a+1,index[o]===!1&&r--):index[o]&&(r=a+1),t="."+i+t}return index["*"+t]?null:r&&n.length>r?n.slice(0,r+1).reverse().join("."):null}function checkPublicSuffix(e,n){var t=getPublicSuffix(e);assert.equal(t,n,e+" should be "+(null==n?"NULL":n)+" but got "+t)}function pubSufTest(){checkPublicSuffix(null,null),checkPublicSuffix("COM",null),checkPublicSuffix("example.COM","example.com"),checkPublicSuffix("WwW.example.COM","example.com"),checkPublicSuffix(".com",null),checkPublicSuffix(".example",null),checkPublicSuffix(".example.com",null),checkPublicSuffix(".example.example",null),checkPublicSuffix("example",null),checkPublicSuffix("example.example",null),checkPublicSuffix("b.example.example",null),checkPublicSuffix("a.b.example.example",null),checkPublicSuffix("local",null),checkPublicSuffix("example.local",null),checkPublicSuffix("b.example.local",null),checkPublicSuffix("a.b.example.local",null),checkPublicSuffix("biz",null),checkPublicSuffix("domain.biz","domain.biz"),checkPublicSuffix("b.domain.biz","domain.biz"),checkPublicSuffix("a.b.domain.biz","domain.biz"),checkPublicSuffix("com",null),checkPublicSuffix("example.com","example.com"),checkPublicSuffix("b.example.com","example.com"),checkPublicSuffix("a.b.example.com","example.com"),checkPublicSuffix("uk.com",null),checkPublicSuffix("example.uk.com","example.uk.com"),checkPublicSuffix("b.example.uk.com","example.uk.com"),checkPublicSuffix("a.b.example.uk.com","example.uk.com"),checkPublicSuffix("test.ac","test.ac"),checkPublicSuffix("cy",null),checkPublicSuffix("c.cy",null),checkPublicSuffix("b.c.cy","b.c.cy"),checkPublicSuffix("a.b.c.cy","b.c.cy"),checkPublicSuffix("jp",null),checkPublicSuffix("test.jp","test.jp"),checkPublicSuffix("www.test.jp","test.jp"),checkPublicSuffix("ac.jp",null),checkPublicSuffix("test.ac.jp","test.ac.jp"),checkPublicSuffix("www.test.ac.jp","test.ac.jp"),checkPublicSuffix("kyoto.jp",null),checkPublicSuffix("c.kyoto.jp",null),checkPublicSuffix("b.c.kyoto.jp","b.c.kyoto.jp"),checkPublicSuffix("a.b.c.kyoto.jp","b.c.kyoto.jp"),checkPublicSuffix("pref.kyoto.jp","pref.kyoto.jp"),checkPublicSuffix("www.pref.kyoto.jp","pref.kyoto.jp"),checkPublicSuffix("city.kyoto.jp","city.kyoto.jp"),checkPublicSuffix("www.city.kyoto.jp","city.kyoto.jp"),checkPublicSuffix("om",null),checkPublicSuffix("test.om",null),checkPublicSuffix("b.test.om","b.test.om"),checkPublicSuffix("a.b.test.om","b.test.om"),checkPublicSuffix("songfest.om","songfest.om"),checkPublicSuffix("www.songfest.om","songfest.om"),checkPublicSuffix("us",null),checkPublicSuffix("test.us","test.us"),checkPublicSuffix("www.test.us","test.us"),checkPublicSuffix("ak.us",null),checkPublicSuffix("test.ak.us","test.ak.us"),checkPublicSuffix("www.test.ak.us","test.ak.us"),checkPublicSuffix("k12.ak.us",null),checkPublicSuffix("test.k12.ak.us","test.k12.ak.us"),checkPublicSuffix("www.test.k12.ak.us","test.k12.ak.us")}var fs=require("fs"),assert=require("assert"),punycode=require("punycode");fs.readFile("./public-suffix.txt","utf8",function(e,n){if(e)throw e;var t=n.split("\n");process.nextTick(function(){processList(t)})});var index={},COMMENT=new RegExp("//.+");