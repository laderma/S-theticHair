var assert=require("assert-plus"),crypto=require("crypto");module.exports={verifySignature:function(e,n){assert.object(e,"parsedSignature"),assert.string(n,"key");var t=e.algorithm.match(/(HMAC|RSA|DSA)-(\w+)/);if(!t||3!==t.length)throw new TypeError("parsedSignature: unsupported algorithm "+e.algorithm);if("HMAC"===t[1]){var r=crypto.createHmac(t[2].toUpperCase(),n);return r.update(e.signingString),r.digest("base64")===e.params.signature}var a=crypto.createVerify(t[0]);return a.update(e.signingString),a.verify(n,e.params.signature,"base64")}};