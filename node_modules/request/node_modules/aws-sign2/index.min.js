function authorization(e){return"AWS "+e.key+":"+sign(e)}function hmacSha1(e){return crypto.createHmac("sha1",e.secret).update(e.message).digest("base64")}function sign(e){return e.message=stringToSign(e),hmacSha1(e)}function signQuery(e){return e.message=queryStringToSign(e),hmacSha1(e)}function stringToSign(e){var n=e.amazonHeaders||"";n&&(n+="\n");var t=[e.verb,e.md5,e.contentType,e.date?e.date.toUTCString():"",n+e.resource];return t.join("\n")}function queryStringToSign(e){return"GET\n\n\n"+e.date+"\n"+e.resource}function canonicalizeHeaders(e){for(var n=[],t=Object.keys(e),r=0,a=t.length;a>r;++r){var i=t[r],s=e[i],i=i.toLowerCase();0===i.indexOf("x-amz")&&n.push(i+":"+s)}return n.sort().join("\n")}function canonicalizeResource(e){var n=parse(e,!0),t=n.pathname,r=[];return Object.keys(n.query).forEach(function(e){if(~keys.indexOf(e)){var t=""==n.query[e]?"":"="+encodeURIComponent(n.query[e]);r.push(e+t)}}),t+(r.length?"?"+r.sort().join("&"):"")}var crypto=require("crypto"),parse=require("url").parse,keys=["acl","location","logging","notification","partNumber","policy","requestPayment","torrent","uploadId","uploads","versionId","versioning","versions","website"];module.exports=authorization,module.exports.authorization=authorization,module.exports.hmacSha1=hmacSha1,module.exports.sign=sign,module.exports.signQuery=signQuery,module.exports.queryStringToSign=stringToSign,module.exports.queryStringToSign=queryStringToSign,module.exports.canonicalizeHeaders=canonicalizeHeaders,module.exports.canonicalizeResource=canonicalizeResource;