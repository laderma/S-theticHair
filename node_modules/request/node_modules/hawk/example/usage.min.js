var Http=require("http"),Request=require("request"),Hawk=require("../lib"),internals={credentials:{dh37fgj492je:{id:"dh37fgj492je",key:"werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn",algorithm:"sha256",user:"Steve"}}},credentialsFunc=function(e,n){return n(null,internals.credentials[e])},handler=function(e,n){Hawk.server.authenticate(e,credentialsFunc,{},function(e,t,r){var a=e?"Shoosh!":"Hello "+t.user+" "+r.ext,i={"Content-Type":"text/plain","Server-Authorization":Hawk.server.header(t,r,{payload:a,contentType:"text/plain"})};n.writeHead(e?401:200,i),n.end(a)})};Http.createServer(handler).listen(8e3,"127.0.0.1"),Request("http://127.0.0.1:8000/resource/1?b=1&a=2",function(e,n,t){console.log(n.statusCode+": "+t)}),credentialsFunc("dh37fgj492je",function(e,n){var t=Hawk.client.header("http://127.0.0.1:8000/resource/1?b=1&a=2","GET",{credentials:n,ext:"and welcome!"}),r={uri:"http://127.0.0.1:8000/resource/1?b=1&a=2",method:"GET",headers:{authorization:t.field}};Request(r,function(e,r,a){var i=Hawk.client.authenticate(r,n,t.artifacts,{payload:a});console.log(r.statusCode+": "+a+(i?" (valid)":" (invalid)")),process.exit(0)})});