var Lab=require("lab"),Hawk=require("../lib"),Package=require("../package.json"),internals={},expect=Lab.expect,before=Lab.before,after=Lab.after,describe=Lab.experiment,it=Lab.test;describe("Hawk",function(){describe("Utils",function(){describe("#parseHost",function(){it("returns port 80 for non tls node request",function(e){var n={method:"POST",url:"/resource/4?filter=a",headers:{host:"example.com","content-type":"text/plain;x=y"}};expect(Hawk.utils.parseHost(n,"Host").port).to.equal(80),e()}),it("returns port 443 for non tls node request",function(e){var n={method:"POST",url:"/resource/4?filter=a",headers:{host:"example.com","content-type":"text/plain;x=y"},connection:{encrypted:!0}};expect(Hawk.utils.parseHost(n,"Host").port).to.equal(443),e()}),it("returns port 443 for non tls node request (IPv6)",function(e){var n={method:"POST",url:"/resource/4?filter=a",headers:{host:"[123:123:123]","content-type":"text/plain;x=y"},connection:{encrypted:!0}};expect(Hawk.utils.parseHost(n,"Host").port).to.equal(443),e()}),it("parses IPv6 headers",function(e){var n={method:"POST",url:"/resource/4?filter=a",headers:{host:"[123:123:123]:8000","content-type":"text/plain;x=y"},connection:{encrypted:!0}},t=Hawk.utils.parseHost(n,"Host");expect(t.port).to.equal("8000"),expect(t.name).to.equal("[123:123:123]"),e()})}),describe("#version",function(){it("returns the correct package version number",function(e){expect(Hawk.utils.version()).to.equal(Package.version),e()})}),describe("#unauthorized",function(){it("returns a hawk 401",function(e){expect(Hawk.utils.unauthorized("kaboom").response.headers["WWW-Authenticate"]).to.equal('Hawk error="kaboom"'),e()})})})});