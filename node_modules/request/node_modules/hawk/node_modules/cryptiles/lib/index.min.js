var Crypto=require("crypto"),Boom=require("boom"),internals={};exports.randomString=function(e){var n=exports.randomBits(6*(e+1));if(n instanceof Error)return n;var t=n.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"");return t.slice(0,e)},exports.randomBits=function(e){if(!e||0>e)return Boom.internal("Invalid random bits count");var n=Math.ceil(e/8);try{return Crypto.randomBytes(n)}catch(t){return Boom.internal("Failed generating random bits: "+t.message)}},exports.fixedTimeComparison=function(e,n){if("string"!=typeof e||"string"!=typeof n)return!1;var t=e.length===n.length?0:1;t&&(n=e);for(var r=0,i=e.length;i>r;++r){var a=e.charCodeAt(r),o=n.charCodeAt(r);t+=a===o?0:1}return 0===t};