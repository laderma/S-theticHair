var hawk={};"undefined"!=typeof module&&module.exports&&(module.exports=hawk),hawk.client={header:function(e,n,t){var r={field:"",artifacts:{}};if(!e||"string"!=typeof e&&"object"!=typeof e||!n||"string"!=typeof n||!t||"object"!=typeof t)return r;var a=t.timestamp||Math.floor((hawk.utils.now()+(t.localtimeOffsetMsec||0))/1e3),i=t.credentials;if(!(i&&i.id&&i.key&&i.algorithm))return r;if(-1===hawk.crypto.algorithms.indexOf(i.algorithm))return r;"string"==typeof e&&(e=hawk.utils.parseUri(e));var s={ts:a,nonce:t.nonce||hawk.utils.randomString(6),method:n,resource:e.relative,host:e.hostname,port:e.port,hash:t.hash,ext:t.ext,app:t.app,dlg:t.dlg};r.artifacts=s,!s.hash&&t.hasOwnProperty("payload")&&(s.hash=hawk.crypto.calculatePayloadHash(t.payload,i.algorithm,t.contentType));var o=hawk.crypto.calculateMac("header",i,s),l=null!==s.ext&&void 0!==s.ext&&""!==s.ext,u='Hawk id="'+i.id+'", ts="'+s.ts+'", nonce="'+s.nonce+(s.hash?'", hash="'+s.hash:"")+(l?'", ext="'+hawk.utils.escapeHeaderAttribute(s.ext):"")+'", mac="'+o+'"';return s.app&&(u+=', app="'+s.app+(s.dlg?'", dlg="'+s.dlg:"")+'"'),r.field=u,r},authenticate:function(e,n,t,r){if(r=r||{},e.getResponseHeader("www-authenticate")){var a=hawk.utils.parseAuthorizationHeader(e.getResponseHeader("www-authenticate"),["ts","tsm","error"]);if(!a)return!1;if(a.ts){var i=hawk.crypto.calculateTsMac(a.ts,n);if(i!==a.tsm)return!1;hawk.utils.setNtpOffset(a.ts-Math.floor(Date.now()/1e3))}}if(!e.getResponseHeader("server-authorization")&&!r.required)return!0;var a=hawk.utils.parseAuthorizationHeader(e.getResponseHeader("server-authorization"),["mac","ext","hash"]);if(!a)return!1;var s={ts:t.ts,nonce:t.nonce,method:t.method,resource:t.resource,host:t.host,port:t.port,hash:a.hash,ext:a.ext,app:t.app,dlg:t.dlg},o=hawk.crypto.calculateMac("response",n,s);if(o!==a.mac)return!1;if(!r.hasOwnProperty("payload"))return!0;if(!a.hash)return!1;var l=hawk.crypto.calculatePayloadHash(r.payload,n.algorithm,e.getResponseHeader("content-type"));return l===a.hash},message:function(e,n,t,r){if(!e||"string"!=typeof e||!n||"number"!=typeof n||null===t||void 0===t||"string"!=typeof t||!r||"object"!=typeof r)return null;var a=r.timestamp||Math.floor((hawk.utils.now()+(r.localtimeOffsetMsec||0))/1e3),i=r.credentials;if(!(i&&i.id&&i.key&&i.algorithm))return null;if(-1===hawk.crypto.algorithms.indexOf(i.algorithm))return null;var s={ts:a,nonce:r.nonce||hawk.utils.randomString(6),host:e,port:n,hash:hawk.crypto.calculatePayloadHash(t,i.algorithm)},o={id:i.id,ts:s.ts,nonce:s.nonce,hash:s.hash,mac:hawk.crypto.calculateMac("message",i,s)};return o}},hawk.crypto={headerVersion:"1",algorithms:["sha1","sha256"],calculateMac:function(e,n,t){var r=hawk.crypto.generateNormalizedString(e,t),a=CryptoJS["Hmac"+n.algorithm.toUpperCase()](r,n.key);return a.toString(CryptoJS.enc.Base64)},generateNormalizedString:function(e,n){var t="hawk."+hawk.crypto.headerVersion+"."+e+"\n"+n.ts+"\n"+n.nonce+"\n"+(n.method||"").toUpperCase()+"\n"+(n.resource||"")+"\n"+n.host.toLowerCase()+"\n"+n.port+"\n"+(n.hash||"")+"\n";return n.ext&&(t+=n.ext.replace("\\","\\\\").replace("\n","\\n")),t+="\n",n.app&&(t+=n.app+"\n"+(n.dlg||"")+"\n"),t},calculatePayloadHash:function(e,n,t){var r=CryptoJS.algo[n.toUpperCase()].create();return r.update("hawk."+hawk.crypto.headerVersion+".payload\n"),r.update(hawk.utils.parseContentType(t)+"\n"),r.update(e||""),r.update("\n"),r.finalize().toString(CryptoJS.enc.Base64)},calculateTsMac:function(e,n){var t=CryptoJS["Hmac"+n.algorithm.toUpperCase()]("hawk."+hawk.crypto.headerVersion+".ts\n"+e+"\n",n.key);return t.toString(CryptoJS.enc.Base64)}},hawk.utils={storage:{_cache:{},setItem:function(e,n){hawk.utils.storage._cache[e]=n},getItem:function(e){return hawk.utils.storage._cache[e]}},setStorage:function(e){var n=hawk.utils.getNtpOffset()||0;hawk.utils.storage=e,hawk.utils.setNtpOffset(n)},setNtpOffset:function(e){hawk.utils.storage.setItem("hawk_ntp_offset",e)},getNtpOffset:function(){return parseInt(hawk.utils.storage.getItem("hawk_ntp_offset")||"0",10)},now:function(){return Date.now()+hawk.utils.getNtpOffset()},escapeHeaderAttribute:function(e){return e.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')},parseContentType:function(e){return e?e.split(";")[0].trim().toLowerCase():""},parseAuthorizationHeader:function(e,n){if(!e)return null;var t=e.match(/^(\w+)(?:\s+(.*))?$/);if(!t)return null;var r=t[1];if("hawk"!==r.toLowerCase())return null;var a=t[2];if(!a)return null;var i={},s=a.replace(/(\w+)="([^"\\]*)"\s*(?:,\s*|$)/g,function(e,t,r){return-1===n.indexOf(t)||null===r.match(/^[ \w\!#\$%&'\(\)\*\+,\-\.\/\:;<\=>\?@\[\]\^`\{\|\}~]+$/)||i.hasOwnProperty(t)?void 0:(i[t]=r,"")});return""!==s?null:i},randomString:function(e){for(var n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",t=n.length,r=[],a=0;e>a;++a)r[a]=n[Math.floor(Math.random()*t)];return r.join("")},parseUri:function(e){for(var n=["source","protocol","authority","userInfo","user","password","hostname","port","resource","relative","pathname","directory","file","query","fragment"],t=/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?)(?:#(.*))?)/,r=t.exec(e),a={},i=15;i--;)a[n[i]]=r[i]||"";return(null===a.port||""===a.port)&&(a.port="http"===a.protocol.toLowerCase()?"80":"https"===a.protocol.toLowerCase()?"443":""),a}};var CryptoJS=CryptoJS||function(e,n){var t={},r=t.lib={},a=function(){},i=r.Base={extend:function(e){a.prototype=this;var n=new a;return e&&n.mixIn(e),n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var n in e)e.hasOwnProperty(n)&&(this[n]=e[n]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=t!=n?t:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var n=this.words,t=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var a=0;e>a;a++)n[r+a>>>2]|=(t[a>>>2]>>>24-8*(a%4)&255)<<24-8*((r+a)%4);else if(65535<t.length)for(a=0;e>a;a+=4)n[r+a>>>2]=t[a>>>2];else n.push.apply(n,t);return this.sigBytes+=e,this},clamp:function(){var n=this.words,t=this.sigBytes;n[t>>>2]&=4294967295<<32-8*(t%4),n.length=e.ceil(t/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(n){for(var t=[],r=0;n>r;r+=4)t.push(4294967296*e.random()|0);return new s.init(t,n)}}),o=t.enc={},l=o.Hex={stringify:function(e){var n=e.words;e=e.sigBytes;for(var t=[],r=0;e>r;r++){var a=n[r>>>2]>>>24-8*(r%4)&255;t.push((a>>>4).toString(16)),t.push((15&a).toString(16))}return t.join("")},parse:function(e){for(var n=e.length,t=[],r=0;n>r;r+=2)t[r>>>3]|=parseInt(e.substr(r,2),16)<<24-4*(r%8);return new s.init(t,n/2)}},u=o.Latin1={stringify:function(e){var n=e.words;e=e.sigBytes;for(var t=[],r=0;e>r;r++)t.push(String.fromCharCode(n[r>>>2]>>>24-8*(r%4)&255));return t.join("")},parse:function(e){for(var n=e.length,t=[],r=0;n>r;r++)t[r>>>2]|=(255&e.charCodeAt(r))<<24-8*(r%4);return new s.init(t,n)}},c=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(n){throw Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},f=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=c.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(n){var t=this._data,r=t.words,a=t.sigBytes,i=this.blockSize,o=a/(4*i),o=n?e.ceil(o):e.max((0|o)-this._minBufferSize,0);if(n=o*i,a=e.min(4*n,a),n){for(var l=0;n>l;l+=i)this._doProcessBlock(r,l);l=r.splice(0,n),t.sigBytes-=a}return new s.init(l,a)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=f.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(n,t){return new e.init(t).finalize(n)}},_createHmacHelper:function(e){return function(n,t){return new d.HMAC.init(e,t).finalize(n)}}});var d=t.algo={};return t}(Math);!function(){var e=CryptoJS,n=e.lib,t=n.WordArray,r=n.Hasher,a=[],n=e.algo.SHA1=r.extend({_doReset:function(){this._hash=new t.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,n){for(var t=this._hash.words,r=t[0],i=t[1],s=t[2],o=t[3],l=t[4],u=0;80>u;u++){if(16>u)a[u]=0|e[n+u];else{var c=a[u-3]^a[u-8]^a[u-14]^a[u-16];a[u]=c<<1|c>>>31}c=(r<<5|r>>>27)+l+a[u],c=20>u?c+((i&s|~i&o)+1518500249):40>u?c+((i^s^o)+1859775393):60>u?c+((i&s|i&o|s&o)-1894007588):c+((i^s^o)-899497514),l=o,o=s,s=i<<30|i>>>2,i=r,r=c}t[0]=t[0]+r|0,t[1]=t[1]+i|0,t[2]=t[2]+s|0,t[3]=t[3]+o|0,t[4]=t[4]+l|0},_doFinalize:function(){var e=this._data,n=e.words,t=8*this._nDataBytes,r=8*e.sigBytes;return n[r>>>5]|=128<<24-r%32,n[(r+64>>>9<<4)+14]=Math.floor(t/4294967296),n[(r+64>>>9<<4)+15]=t,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=r._createHelper(n),e.HmacSHA1=r._createHmacHelper(n)}(),function(e){for(var n=CryptoJS,t=n.lib,r=t.WordArray,a=t.Hasher,t=n.algo,i=[],s=[],o=function(e){return 4294967296*(e-(0|e))|0},l=2,u=0;64>u;){var c;e:{c=l;for(var f=e.sqrt(c),d=2;f>=d;d++)if(!(c%d)){c=!1;break e}c=!0}c&&(8>u&&(i[u]=o(e.pow(l,.5))),s[u]=o(e.pow(l,1/3)),u++),l++}var h=[],t=t.SHA256=a.extend({_doReset:function(){this._hash=new r.init(i.slice(0))},_doProcessBlock:function(e,n){for(var t=this._hash.words,r=t[0],a=t[1],i=t[2],o=t[3],l=t[4],u=t[5],c=t[6],f=t[7],d=0;64>d;d++){if(16>d)h[d]=0|e[n+d];else{var p=h[d-15],m=h[d-2];h[d]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+h[d-7]+((m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10)+h[d-16]}p=f+((l<<26|l>>>6)^(l<<21|l>>>11)^(l<<7|l>>>25))+(l&u^~l&c)+s[d]+h[d],m=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&a^r&i^a&i),f=c,c=u,u=l,l=o+p|0,o=i,i=a,a=r,r=p+m|0}t[0]=t[0]+r|0,t[1]=t[1]+a|0,t[2]=t[2]+i|0,t[3]=t[3]+o|0,t[4]=t[4]+l|0,t[5]=t[5]+u|0,t[6]=t[6]+c|0,t[7]=t[7]+f|0},_doFinalize:function(){var n=this._data,t=n.words,r=8*this._nDataBytes,a=8*n.sigBytes;return t[a>>>5]|=128<<24-a%32,t[(a+64>>>9<<4)+14]=e.floor(r/4294967296),t[(a+64>>>9<<4)+15]=r,n.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=a._createHelper(t),n.HmacSHA256=a._createHmacHelper(t)}(Math),function(){var e=CryptoJS,n=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=n.parse(t));var r=e.blockSize,a=4*r;t.sigBytes>a&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),s=this._iKey=t.clone(),o=i.words,l=s.words,u=0;r>u;u++)o[u]^=1549556828,l[u]^=909522486;i.sigBytes=s.sigBytes=a,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var n=this._hasher;return e=n.finalize(e),n.reset(),n.finalize(this._oKey.clone().concat(e))}})}(),function(){var e=CryptoJS,n=e.lib.WordArray;e.enc.Base64={stringify:function(e){var n=e.words,t=e.sigBytes,r=this._map;e.clamp(),e=[];for(var a=0;t>a;a+=3)for(var i=(n[a>>>2]>>>24-8*(a%4)&255)<<16|(n[a+1>>>2]>>>24-8*((a+1)%4)&255)<<8|n[a+2>>>2]>>>24-8*((a+2)%4)&255,s=0;4>s&&t>a+.75*s;s++)e.push(r.charAt(i>>>6*(3-s)&63));if(n=r.charAt(64))for(;e.length%4;)e.push(n);return e.join("")},parse:function(e){var t=e.length,r=this._map,a=r.charAt(64);a&&(a=e.indexOf(a),-1!=a&&(t=a));for(var a=[],i=0,s=0;t>s;s++)if(s%4){var o=r.indexOf(e.charAt(s-1))<<2*(s%4),l=r.indexOf(e.charAt(s))>>>6-2*(s%4);a[i>>>2]|=(o|l)<<24-8*(i%4),i++}return n.create(a,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}();