"use strict";function nop(){}function Server(n,e,a){var r=this;"function"==typeof e&&(a=e,e=void 0);var t=function(n){var e=new Connection(n,r,function(){r.connections.push(e),e.removeListener("error",nop),r.emit("connection",e)});e.on("close",function(){var n=r.connections.indexOf(e);-1!==n&&r.connections.splice(n,1)}),e.on("error",nop)};n?this.socket=tls.createServer(e,t):this.socket=net.createServer(e,t),this.socket.on("close",function(){r.emit("close")}),this.socket.on("error",function(n){r.emit("error",n)}),this.connections=[],events.EventEmitter.call(this),a&&this.on("connection",a)}var util=require("util"),net=require("net"),tls=require("tls"),events=require("events"),Connection;util.inherits(Server,events.EventEmitter),module.exports=Server,Connection=require("./Connection"),Server.prototype.listen=function(n,e,a){var r=this;return"function"==typeof e&&(a=e,e=void 0),a&&this.on("listening",a),this.socket.listen(n,e,function(){r.emit("listening")}),this};