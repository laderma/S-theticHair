function broadcast(e){server.connections.forEach(function(n){n.sendText(e)})}var http=require("http"),ws=require("../../"),fs=require("fs");http.createServer(function(e,n){fs.createReadStream("index.html").pipe(n)}).listen(8080);var server=ws.createServer(function(e){e.nickname=null,e.on("text",function(n){null===e.nickname?(e.nickname=n,broadcast(n+" entered")):broadcast("["+e.nickname+"] "+n)}),e.on("close",function(){broadcast(e.nickname+" left")})});server.listen(8081);