"use strict";function generateMetaData(n,e,a,r){var t,i,s,l,o;if(t=r.length,i=new Buffer(2+(126>t?0:65536>t?2:8)+(a?4:0)),i[0]=(n?128:0)+e,i[1]=a?128:0,s=2,126>t?i[1]+=t:65536>t?(i[1]+=126,i.writeUInt16BE(t,2),s+=2):(i[1]+=127,i.writeUInt32BE(Math.floor(t/Math.pow(2,32)),2),i.writeUInt32BE(t%Math.pow(2,32),6),s+=8),a){for(l=new Buffer(4),o=0;4>o;o++)i[s+o]=l[o]=Math.floor(256*Math.random());for(o=0;o<r.length;o++)r[o]^=l[o%4];s+=4}return i}exports.createTextFrame=function(n,e){var a,r;return a=new Buffer(n),r=generateMetaData(!0,1,void 0===e?!1:e,a),Buffer.concat([r,a],r.length+a.length)},exports.createBinaryFrame=function(n,e,a,r){var t,i;return a=void 0===a?!0:a,e=void 0===e?!1:e,e?(t=new Buffer(n.length),n.copy(t)):t=n,i=generateMetaData(void 0===r?!0:r,a?2:0,e,t),Buffer.concat([i,t],i.length+t.length)},exports.createCloseFrame=function(n,e,a){var r,t;return void 0!==n&&1005!==n?(r=new Buffer(void 0===e?"--":"--"+e),r.writeUInt16BE(n,0)):r=new Buffer(0),t=generateMetaData(!0,8,void 0===a?!1:a,r),Buffer.concat([t,r],t.length+r.length)},exports.createPingFrame=function(n){return generateMetaData(!0,9,void 0===n?!1:n,new Buffer(0))},exports.createPongFrame=function(n,e){var a,r;return a=new Buffer(n),r=generateMetaData(!0,10,void 0===e?!1:e,a),Buffer.concat([r,a],r.length+a.length)};